<!DOCTYPE html>
<html>

<head>
	<title>sudedu LT</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="sudEdu skirtas priešmokyklinio ugdymo, pradinių bei aukštesnių klasių mokinių aritmetinių veiksmų (sudėties, atimties, daugybos, dalybos) mintinio skaičiavimo, teksto supratimo bei rašymo gebėjimų gilinimui. Skaičiavimas mintinai ne tik lavina atmintį, bet ir lengvina bei spartina matematikos mokymąsi. Skaitymo supratimas šiandien itin svarbus, nes jis suteikia galimybę atsirinkti ir kritiškai vertinti gausią informaciją, padeda orientuotis informacijos sraute bei išskirti patikimus šaltinius, kad galėtume priimti pagrįstus sprendimus."> 
	<meta name="keywords" content="mintinis skaičiavimas, mintinas skaičiavimas, skaičiavimas mintinai, matematika, pradinukai, priešmokyklinis ugdymas, priešmokyklinukai, pradinis ugdymas, atminties lavinimas, skaitinė lygybė, skaitinė lygybė su nežinomuoju, sudėtis, dėmuo, atimtis, turinys, atėminys, daugyba, dauginamasis, daugiklis, dalyba, dalinis, daliklis, daugybos lentelė, lentelinė sudėtis, lentelinė atimtis, sudėtis iki 10, sudėtis iki 20, sudėtis iki 100, sudėtis iki 1000, atimtis iki 10, atimtis iki 20, atimtis iki 100, atimtis iki 1000, vienaženkliai skaičiai, dviženkliai skaičiai, triženkliai skaičiai, keturženkliai skaičiai, peržengiant dešimtį, peržengiant šimtą, peržengiant tūkstančių vienetus, išardant dešimtį, išardant šimtą, išardant tūkstančių vienetus, pergrupuojant dešimtis, pergrupuojant šimtus, peržengiant tūkstančių vienetus, skaitymas, teksto supratimas, skaitymo supratimas, rašymas, struktūros išdėstymas, turinio komponavimas, įsidėmėtina rašyba, raidė, raidės, balsė, balsės, dvibalsė, dvibalsės, priebalsė, priebalsės, panašiai skambančios priebalsės, mišrusis dvigarsis, mišrieji dvigarsiai, priešdėlis, priešdėliai, priesaga, priesagos, galūnė, žodžio galūnė, žodžio pabaiga, daiktavardis, būdvardis, prieveiksmis, veiksmažodis, daiktavardžiai, būdvardžiai, prieveiksmiai, veiksmažodžiai">
	
	<link rel="canonical" href="https://www.sudedu.lt/LT/">
	<link rel="alternate" href="https://www.sudedu.lt/LT/" hreflang="lt">
	<link rel="alternate" href="https://www.sudedu.lt/EN/" hreflang="en">
	<link rel="icon" href="../images/favicon.ico" type="image/x-icon">
	<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" type="text/css" href="../index.css">
    <link rel="stylesheet" href="../main-nav-bar.css">

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-96Q83PW8XY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-96Q83PW8XY');
</script>	
<script src="../refresh-token.js"></script>

<style>
	* {
		-webkit-user-select: none;
		-webkit-tap-highlight-color: transparent;
		user-select: none;
        box-sizing: border-box;
	}

	html {
		display: flex;
		justify-content: center;
		align-items: center;
		background-image: linear-gradient(to top, #ffbf9c, #ffbf92, #ffbf89, #ffbf7e, #ffc074);
		width: 100vw;
		height: 100svh;
		overflow: hidden;
		user-select: none;         /* Standard */
		-webkit-user-select: none; /* Chrome, Safari, Edge */
		-moz-user-select: none;    /* Firefox */
		-ms-user-select: none;     /* IE/older Edge */
	}

	body {
		margin: 0;
		font-family: 'SFpro', sans-serif;
		display: flex;
		flex-direction: column;
		align-items: center;
		width: 100%;
		height: 100%;
		overflow: hidden;
	}

	.container {
		position: relative;
		height: calc(100% - 80px - 16px - 16px);
		max-height: calc(100% - 80px - 16px - 16px);
		min-height: calc(100% - 80px - 16px - 16px);
		width: calc(100% - 16px - 16px);
		display: flex;
		background: rgba(255, 255, 255, 0.08);
		margin: 16px;
		border-radius: 20px;
		border: 1px solid rgba(255, 255, 255, 0.1);
		box-shadow: 0 8px 40px rgba(0, 0, 0, 0.1);
	}

    .hidden {
        display: none;
    }

.container-inner {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
  box-sizing: border-box; /* include padding in height calculations */
  padding: 25px;
  overflow: hidden; /* clip any overflow inside container */
}

.container-inner.wrapped {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
  box-sizing: border-box; /* include padding in height calculations */
  padding: 0px 25px;
  overflow: hidden; /* clip any overflow inside container */
}

.practice-label-div,
.submit-button-div {
  display: flex;
  align-items: center;
  justify-content: center;
   max-width: 500px;
   width: 100%;
}

.practice-label::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 50%;
    transform: translateX(-50%);
    width: 60px;
    height: 4px;
    background: linear-gradient(90deg, #3288AC, #40c9a9);
    border-radius: 2px;
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0%, 100% { width: 60px; opacity: 1; }
    50% { width: 80px; opacity: 0.7; }
}

.submit-button-div {
  padding: 16px 0 0 0;
  gap: 5px
}

.practice-outer-div {
    position: relative;
    display: flex;
    flex-direction: column;
    height: 100%;
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    padding: 20px;
    border-radius: 25px;
    justify-content: start;
    align-items: center;
}


.personal-chl {
    position: relative;
    display: flex;
    flex-direction: column;
    height: 100%;
    justify-content: end;
}

.practice-outer-div,
.personal-chl {
    flex: 1 1 400px;
}

.middle-div.wrapped {
    overflow: auto;
    padding: 20px 0;
    gap: 15px;
}

.middle-div.wrapped .practice-outer-div,
.middle-div.wrapped .personal-chl {
    max-width: 100%;
    flex: none;
    width: 100%;
}

.middle-div.wrapped .personal-chl {
    height: auto;
}

.middle-div.wrapped .practice-outer-div.overflowing {
    height: 100%;
}

.middle-div.wrapped .practice-outer-div {
    max-height: 90%;
}

.personal-chl-inner {
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    padding: 20px;
    border-radius: 25px;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.middle-div {
  height: 100%;
  display: flex;
  flex-direction: row;
  flex: 1 1 auto;   /* take remaining space */
  min-height: 0;    /* allow shrinking */
  min-width: 0;     /* allow horizontal shrink if needed */
  align-items: start;
  justify-content: center;
  gap: 25px;
  flex-wrap: wrap;
}

.new-task-outer-div {
    display: flex;
    align-items: start;
    justify-content: center;
    overflow: hidden;
    width: 100%;
}

#new-task-options-container {
    max-height: 100%;
    justify-content: start;
    overflow: hidden;
    position: relative;
}

#new-task-options-container-inner {
    display: flex;
    flex-direction: column;
    overflow-y: auto;
    overflow-x: hidden;
    scrollbar-gutter: stable;
    padding: 15px 3px 15px 15px;
    position: relative;
    height: 100%;
    -webkit-overflow-scrolling: touch;
    -webkit-overflow-scrolling: touch !important;
}

#mode_choice {
    margin-top: 0;
}

	.practice-label {
        font-size: 2rem;
        font-weight: 800;
        opacity: 0.9;
        margin-bottom: 16px;
        position: relative;
	}

	.lm-animated-bg {
		position: absolute;
		width: 100vw;
		height: auto;
		top: -18px;
		left: -18px;
		right: -18px;
		bottom: -18px;
		background-image: url(../images/main_bg.png);
		background-position: center center;
		background-size: cover;
		background-repeat: no-repeat;
		z-index: -1;
		opacity: 1;
	}


.submit-button-outer {
    display: flex;
    flex: 1 1 auto;
}   

.earnings-estimation-outer {
    display: flex;
    justify-content: end;
    flex: 1 1 auto;
}

.submit-button {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  border: none;
  /*border: #286D8A 1px solid;*/
  background: linear-gradient(135deg, #3288AC, #286D8A);
  border-radius: 25px;
  cursor: pointer;
  font-size: 1rem;
  color: #F5F5F7;
  overflow: hidden;
  min-width: 0;
  padding: 12px 10px;
  font-weight: 600;
  letter-spacing: 0.01em;
  font-size: 1.15rem;
  width: 150px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  text-transform: uppercase;
  letter-spacing: 0.05rem;
  /*box-shadow: 
        0 1px 2px rgba(0, 0, 0, 0.2),
        0 4px 12px rgba(50, 136, 172, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);*/
}

.submit-button::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.12) 0%, rgba(255, 255, 255, 0) 100%);
  border-radius: 20px;
  pointer-events: none;
  transition: background 0.3s ease;
}

.submit-button::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 20px;
  padding: 1px;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  pointer-events: none;
}

.submit-button:hover::before {
  background: rgba(255, 255, 255, 0.15);
}


	/* POPUP STYLES START */
.class-popup-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    z-index: 10000;
    justify-content: center;
    align-items: center;
}

.class-popup-content {
    background-color: #fff;
    padding: 30px;
    border-radius: 15px;
    box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
    width: 90%;
    max-width: 500px;
    text-align: center;
    position: relative;
}

.class-popup-title {
    font-size: 24px;
    margin-bottom: 20px;
    color: #2c3e50;
    font-weight: bold;
}

.class-options {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
    margin-bottom: 25px;
}

.class-option {
    padding: 12px 20px;
    background-color: #f8f9fa;
    border: 2px solid #dee2e6;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 500;
}

.class-option:hover {
    background-color: #e9ecef;
    transform: translateY(-2px);
}

.class-option.selected {
    background-color: #40c9a9;
    color: white;
    border-color: #40c9a9;
}

.class-popup-note {
    font-size: 14px;
    color: #6c757d;
    margin-top: 15px;
}

/* Make the popup modal visible when needed */
.class-popup-modal.active {
    display: flex;
}

/* Prevent scrolling when popup is active */
body.popup-active {
    overflow: hidden;
}

.class-popup-button {
    padding: 12px 25px;
    background-color: #40c9a9;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 500;
    font-size: 16px;
    transition: all 0.3s ease;
    margin-top: 10px;
}

.class-popup-button:hover {
    background-color: #40c9a9;
    transform: translateY(-2px);
}

.class-popup-button:disabled {
    background-color: #adb5bd;
    cursor: not-allowed;
    transform: none;
}

        .message-board-personal-chl-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            gap: 25px;
            flex-wrap: wrap;
            min-width: 0;
            flex: 1 1 400px;
        }

        .container-inner.wrapped .message-board-personal-chl-container {
            height: auto;
            width: 100%;
            gap: 15px;
        }

        .container-inner.wrapped .message-board {
            min-height: 200px;
        }

        .message-board-container {
            flex: 1;
        }

        .message-board-container {
            display: flex;
            flex-direction: column;
            flex: 1 1 auto;
            min-height: 0;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 20px;
            border-radius: 20px;
        }

        .board-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
            flex-shrink: 0;
            padding: 0 5px;
        }

        .board-title {
            font-size: 1.15rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: rgba(0, 0, 0, 0.7);
        }

        .board-date {
            font-size: 0.85rem;
            color: rgba(0, 0, 0, 0.5);
            font-weight: 600;
        }

        .message-board {
            flex: 1 1 0px;
            min-height: 0;
            overflow-y: auto;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 14px;
        }

        .board-message {
            font-size: 0.9rem;
            color: rgba(0, 0, 0, 0.75);
            line-height: 1.6;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.2s ease;
            border-radius: 8px;
            padding: 8px;
            margin-left: -8px;
            margin-right: -8px;
        }

        .board-message:hover {
            background: rgba(255, 255, 255, 0.2);
            color: rgba(0, 0, 0, 0.85);
        }

        .board-message:last-child {
            margin-bottom: 0;
        }

        .message-text {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .message-meta {
            font-size: 0.7rem;
            color: rgba(0, 0, 0, 0.5);
            margin-top: 4px;
            font-style: italic;
        }

        .empty-message {
            text-align: center;
            color: rgba(0, 0, 0, 0.5);
            font-size: 0.8rem;
            padding: 20px 0;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .personal-chl-content-holder {
            width: 100%;
            padding: 15px 0 0 0;
        }

        .personal-chl-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 0 1 auto;
            padding: 20px;
        }

        .practice-label {
            font-size: 2rem;
            font-weight: 700;
            opacity: 0.9;
            margin-bottom: 16px;
            text-align: center;
            position: relative;
        }

        .practice-label::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 4px;
            background: linear-gradient(90deg, #3288AC, #40c9a9);
            border-radius: 2px;
        }

        .chl-pills-container {
            display: flex;
            gap: 6px;
            margin-bottom: 12px;
            background: rgba(255, 255, 255, 0.15);
            padding: 6px;
            border-radius: 18px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .chl-pill {
            flex: 1;
            padding: 12px 8px;
            background: transparent;
            border: none;
            border-radius: 13px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.03em;
            color: rgba(0, 0, 0, 0.65);
            text-align: center;
            line-height: 1.3;
            position: relative;
        }

        .chl-pill:hover:not(.active) {
            background: rgba(255, 255, 255, 0.3);
            color: rgba(0, 0, 0, 0.8);
        }

        .chl-pill.active {
            background: linear-gradient(135deg, #A0C58F, #32ac93);
            color: white;
            box-shadow: 0 2px 8px rgba(64, 201, 169, 0.3);
        }

        .chl-content-container {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 18px;
            padding: 20px;
            position: relative;
            height: 200px;
            overflow: hidden;
            container-type: inline-size;
        }

        .chl-content {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: none;
            display: flex;
            flex-direction: column;
        }

        .chl-content.active {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }

        .chl-title-holder {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chl-title {
            font-size: 1.15rem;
            font-weight: 800;
            color: rgba(0, 0, 0, 0.85);
            text-transform: uppercase;
            letter-spacing: 0.03em;
            background: linear-gradient(135deg, #3288AC, #286D8A);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .chl-title .earnings-estimation-outer {
            font-size: 1rem;
        }

        .chl-info {
            font-size: 0.9rem;
            color: rgba(0, 0, 0, 0.75);
            line-height: 1.6;
            font-weight: 500;
            margin-bottom: 5px;
            flex: 1;
            overflow-y: auto;
            padding-right: 4px;
            display: flex;
            align-items: center;
        }

        .chl-info::-webkit-scrollbar {
            width: 4px;
        }

        .chl-info::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
        }

        .chl-info::-webkit-scrollbar-thumb {
            background: rgba(50, 136, 172, 0.4);
            border-radius: 10px;
        }

        .chl-action-button {
            position: relative;
            width: 100px;
            align-self: end;
            padding: 12px;
            border: none;
            background: linear-gradient(135deg, #3288AC, #286D8A);
            color: white;
            font-size: 0.95rem;
            font-weight: 700;
            letter-spacing: 0.05em;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            border-radius: 20px;
        }

        .middle-div.wrapped .chl-action-button {
            width: 100%;
        }
        @container (min-width: 400px) {
        .middle-div.wrapped .chl-action-button {
            width: 100px;
        }
        }

        .chl-action-button::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.12) 0%, rgba(255, 255, 255, 0) 100%);
            border-radius: 20px;
            pointer-events: none;
            transition: background 0.3s ease;
        }

        .chl-action-button::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 20px;
            padding: 1px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            pointer-events: none;
        }

        .chl-action-button:hover::before {
            background: rgba(255, 255, 255, 0.15);
        }


@media (min-device-width: 768px) and (max-device-width: 1200px) and (orientation: portrait) {
    .container {
        background-color: transparent;
        border: none;
        padding: 0;
        box-shadow: none;
    }

    .container-inner {
        padding: 0 !important;
    }

    .middle-div {
        padding: 0 !important;
    }

    .practice-label {
        font-size: 2.5rem;
    }

    #group_name, #mode_choice, #mode_choice_1, #mode_choice_2, #mode_choice_3, #mode_choice_4, #mode_choice_5, #mode_choice_6, #mode_choice_7, #mode_choice_8, #mode_choice_9, #mode_choice_10, #mode_choice_13, #class_choice {
        font-size: 1.5rem;
    }

    .submit-button {
        font-size: 1.4rem;
        padding: 16px 18px;
    }

    #personalChlContainer {
        padding: 15px 0;
    }
    
    .chl-pill {
        font-size: 1.15rem;
    }

    .chl-title {
        font-size: 1.5rem;
    }

    .earnings-iki-holder,
    .coin-amount {
        font-size: 1.35rem;
    }

    .coin-icon img {
        width: 36px;
        height: 36px;
    }

    .chl-info {
        font-size: 1.15rem;
    }

    .board-title {
        font-size: 1.25rem;
    }

    .board-date {
        font-size: 1rem;
    }

    .submit-button {
        font-size: 1.35rem;
    }

    .board-message {
        font-size: 1.1rem;
    }

    .chl-action-button {
        font-size: 1.25rem;
    }

    .middle-div.wrapped .chl-action-button {
        width: 120px;
    }

    .message-meta {
        font-size: 0.9rem;
    }
}

@media (max-width: 767px) {
	.container {
		width: 100%;
		max-height: calc(100% - 80px);
		min-height: calc(100% - 80px);
		margin: 0;
		background: transparent;
		border: none;
		border-radius: 0;
		padding: 0;
	}

	.container-inner {
		padding: 15px;
	}

    .practice-outer-div {
        width: 70%;
        min-width: 0;
    }

     .message-board-container {
            padding: 15px;
        }

        .board-title {
            font-size: 0.8rem;
        }

        .board-message {
            font-size: 0.8rem;
        }

        .message-board {
            padding: 12px;
            min-height: 70px;
            max-height: 110px;
        }

    .practice-label {
        font-size: 1.5rem;
    }

    .chl-pill {
        padding: 11px 6px;
        font-size: 0.75rem;
    }

    .chl-content-container {
        height: 220px;
        padding: 18px;
    }

    .chl-content {
        top: 18px;
        left: 18px;
        right: 18px;
        bottom: 18px;
    }

    .chl-title {
        font-size: 1.05rem;
    }

    .container-inner.wrapped {
        padding: 0;
    }

    .middle-div.wrapped {
        padding: 15px;
    }
}

@media (hover: none) and (pointer: coarse) {
    #personalChlContainer {
        padding: 15px;
    }

    #new-task-options-container-inner {
        padding: 15px;
    }
}


@media (max-width: 575px) {
	.container {
		padding: 0;
	}

    .practice-outer-div {
        width: 100%;
        padding: 15px;
        max-height: 90%;
    }

    .practice-label {
        font-size: 1.75rem;
    }

    #new-task-options-container-inner {
        overflow-y: auto;
        scrollbar-gutter: stable;
        padding: 10px 0;
    }

    #personalChlContainer {
        padding: 10px 0;
    }

    .personal-chl-container {
        padding: 15px;
    }

    .personal-chl-content-holder {
        padding: 10px 0 0 0;
        max-width: 100%;
    }

    .container-inner.wrapped {
        padding: 0;
    }

    .middle-div.wrapped {
        padding: 15px;
    }
}

/* POPUP STYLES END */
</style>
</head>

<body>
	<div id="customConfirmModal" class="modal">
    <div class="modal-content">
        <p id="customModalText"></p>
        <div class="modal-buttons">
        <button id="customConfirmYes" class="btn btn-confirm">Taip</button>
        <button id="customConfirmNo" class="btn btn-cancel">Ne</button>
        </div>
    </div>
    </div>

    <div id="object-popup" class="object-popup-overlay" style="display:none;">
    <div class="object-popup-panel">
        <button class="object-popup-close">&times;</button>
        <div class="title-subtitle-inline-button-wrapper">
        <div class="object-popup-title-subtitle-wrapper">
        <div class="object-popup-title" id="object-popup-title"></div>
        <div class="object-popup-subtitle" id="object-popup-subtitle"></div>
        </div>
        </div>
        <div class="object-popup-content" id="object-popup-content">
        <!-- Dynamic content goes here -->
        </div>
    </div>
    </div>

     <nav class="main-navbar" id="mainNavbar">
        <div class="main-nav-container">
            <!-- Logo -->
            <a href="#" class="main-nav-logo">
                <div class="main-nav-logo-icon">
                 <img id="sudedu-main-nav-bar-logo" src="../images/sudedu_logo.png" alt="sudEdu">
                </div>
            </a>

            <!-- Desktop Navigation -->
            <div class="main-nav-links invisible">
                <a href="index.html" class="main-nav-link main-nav-link-active">Praktika</a>
                <a href="uzduotys.html" class="main-nav-link">Užduotys</a>
                <a href="klase.html" class="main-nav-link">Klasė</a>
                <a href="augintiniai.html" class="main-nav-link">Augintiniai</a>
                <a href="apie.html" class="main-nav-link">Apie Sudedu</a>
                
                <div class="main-nav-language-dropdown" id="languageDropdown">
                    <button class="main-nav-language-btn" id="languageBtn">
                        <span id="currentLanguage">LT</span>
                        <span class="main-nav-language-arrow"></span>
                    </button>
                    <div class="main-nav-language-menu">
                        <button class="main-nav-language-option selected" data-lang="LT">LT</button>
                        <button class="main-nav-language-option" data-lang="EN">EN</button>
                    </div>
                </div>
                
                
                <div class="main-nav-connect-wrapper">
                    <div class="main-nav-connect-glow"></div>
                    <button class="main-nav-log-out-btn">
                        <span class="main-nav-connect-text">Atsijungti</span>
                    </button>

                    <button class="main-nav-log-in-btn">
                        <span class="main-nav-connect-text">Prisijungti</span>
                    </button>
                </div>
            </div>

            <!-- Mobile Button -->
            <button class="main-nav-mobile-btn" id="mainNavMobileBtn">
                <span class="main-nav-hamburger"></span>
                <span class="main-nav-hamburger"></span>
                <span class="main-nav-hamburger"></span>
            </button>

            <!-- Mobile Menu -->
            <div class="main-nav-mobile-menu" id="mainNavMobileMenu">
                <a href="index.html" class="main-nav-mobile-link active">Praktika</a>
                <a href="uzduotys.html" class="main-nav-mobile-link">Užduotys</a>
                <a href="klase.html" class="main-nav-mobile-link">Klasė</a>
                <a href="augintiniai.html" class="main-nav-mobile-link">Augintiniai</a>
                <a href="apie.html" class="main-nav-mobile-link">Apie Sudedu</a>
                
                <div class="main-nav-mobile-language">
                    <button class="language-option language-option-LT selected" onclick="setLanguage('LT')">LT</button>
                    <span class="language-separator">/</span>
                    <button class="language-option language-option-EN" onclick="setLanguage('EN')">EN</button>
                </div>
                
                <button class="main-nav-mobile-log-out-btn">
                    <span class="main-nav-connect-text">Atsijungti</span>
                </button>
                <button class="main-nav-mobile-log-in-btn">
                    <span class="main-nav-connect-text">Prisijungti</span>
                </button>
            </div>
        </div>
    </nav>


	<div class="container" id="template-container" hidden>		
		<!-- POPUP ELEMENTS START -->
		<div class="class-popup-modal" id="classPopup">
			<div class="class-popup-content">
				<h2 class="class-popup-title">Pasirink savo klasę</h2>
				<div class="class-options" style="flex-direction: column;">
					<div class="class-option" data-class="0">Priešmokyklinė</div>
					<div class="class-option" data-class="1">1 klasė</div>
					<div class="class-option" data-class="2">2 klasė</div>
					<div class="class-option" data-class="3">3 klasė</div>
					<div class="class-option" data-class="4">4 klasė</div>
					<div class="class-option" data-class="5">Aukštesnė</div>
				</div>
				<button class="class-popup-button" id="classPopupButton" disabled>Toliau</button>
			</div>
		</div>
		<!-- POPUP ELEMENTS END -->

		<div class="container-inner">
			<div class="middle-div hide-scrollbar">
                <div class="practice-outer-div">
				<div class="practice-label-div free-practice-div">
					<div class="practice-label">PRAKTIKUOTIS</div>
				</div>
				<div class="new-task-outer-div" id="middle-div-row">
		                <div id="new-task-options-container">
                            <div id="new-task-options-container-inner">
                            <div class="ode_choice_div">
                                <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice" id="mode_choice">
                                    <option value="math">MATEMATIKĄ</option>
                                    <option value="lang">LIETUVIŲ KALBĄ</option>
                                </select>
                            </div>

                            <div class="mode_choice_1_div">
                                <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_1" id="mode_choice_1">
                                    <option value="C1">SUDĖTĮ</option>
                                    <option value="C2">ATIMTĮ</option>
                                    <option value="C3">SUDĖTĮ IR ATIMTĮ</option>
                                    <option value="C4">DAUGYBĄ</option>
                                    <option value="C5">DALYBĄ</option>
                                    <option value="C6">DAUGYBĄ IR DALYBĄ</option>
                                    <option value="C7">ĮVAIRIUS VEIKSMUS</option>
                                </select>
                            </div>

                            <div class="mode_choice_2_div">
                                <div class="col-12 d-flex justify-content-center align-items-center mode_choice_2_div text-center" id="mode_choice_2_div">
                                    <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_2" id="mode_choice_2">
                                        <option value="C8">VIENAŽENKLIŲ SKAIČIŲ IKI 10</option>
                                        <option value="C9">VIENAŽENKLIŲ SKAIČIŲ IKI 20 (LENTELINĖ SUDĖTIS)</option>
                                        <option value="C10">DVIŽENKLIO IR VIENAŽENKLIO SKAIČIŲ IKI 20</option>
                                        <option value="C11">DVIŽENKLIO IR VIENAŽENKLIO SKAIČIŲ IKI 100</option>
                                        <option value="C12">DVIŽENKLIŲ SKAIČIŲ IKI 100</option>
                                        <option value="C13">SKAIČIŲ IKI 1 000</option>
                                        <option value="C14">SKAIČIŲ IKI 10 000</option>
                                        <option value="C15">SKAIČIŲ IKI 1 000 000</option>
                                    </select>
                                </div>
                            </div>

                            <div class="selected_numbers_div">
                                <div class="selected_numbers_inner_div">
                                    <label class="number-choice-label-nuo" for="selected_number" id="number_label" style="display: none;">NUO</label>
                                    <select class="btn btn-secondary dropdown-toggle dropdown text-center" name="selected_number" id="selected_number" style="display: none;">
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                        <option value="9">9</option>
                                        <option value="10">10</option>
                                    </select>
                                    <label class="number-choice-label-iki" for="selected_number_2" id="number_label_2" style="display: none;">IKI</label>
                                    <select class="btn btn-secondary dropdown-toggle dropdown text-center" name="selected_number_2" id="selected_number_2" style="display: none;">
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                        <option value="9">9</option>
                                        <option value="10">10</option>
                                    </select>
                                </div>
                            </div>

                            <div class="remainder-div">
                                <label id="remainder-option" style="display: none;">
                                    <input id="remainder-input" type="checkbox" name="myCheckbox"> DALYBA SU LIEKANA
                                </label>
                            </div>

                            <div class="mode_choice_3_div">
                                <div class="col-12 d-flex justify-content-center align-items-center text-center mode_choice_3_div" id="mode_choice_3_div">
                                    <select class="btn btn-secondary dropdown-toggle dropdown text-center" name="mode_choice_3" id="mode_choice_3">
                                        <option value="C37">NEPERŽENGIANT DEŠIMTIES</option>
                                    </select>
                                </div>
                            </div>

                            <div class="mode_choice_5_div">
                                <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_5" id="mode_choice_5">
                                    <option value="C41">SKAITINĖ LYGYBĖ</option>
                                    <option value="C42">SKAITINĖ LYGYBĖ SU NEŽINOMUOJU</option>
                                </select>
                            </div>

                            <div class="mode_choice_6_div">
                                <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_6" id="mode_choice_6" style="display: none;">
                                    <option value="C43">NEŽINOMAS DĖMUO</option>
                                </select>
                            </div>

                            <div class="mode_choice_7_div">
                                <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_7" id="mode_choice_7" style="display: block;">
                                    <option value="C47">EILUTE</option>
                                    <option value="C48">STULPELIU / KAMPU</option>
                                </select>
                            </div>

                            <div class="class_choice_div">
                                <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="class_choice" id="class_choice" style="display: none;">
                                    <option value="C75">1-2 KLASĖ</option>
                                    <option value="C76">3-4 KLASĖ</option>
                                </select>
                            </div>

                            <div class="mode_choice_8_div">
                                <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_8" id="mode_choice_8" style="display: none;">
                                    <option value="C49">TEKSTO SUPRATIMĄ</option>
                                    <option value="C83">GRAMATIKĄ</option>
                                </select>
                            </div>

                            <div class="mode_choice_9_div">
                                <div class="col-12 d-flex justify-content-center align-items-center mode_choice_9_div text-center" id="mode_choice_9_div">
                                    <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_9" id="mode_choice_9" style="display: none;">
                                        <option value="C51">TURINIO KOMPONAVIMĄ</option>
                                        <option value="C52">STRUKTŪROS IŠDĖSTYMĄ</option>
                                    </select>
                                </div>
                            </div>

                            <div class="mode_choice_10_div">
                                <div class="col-12 d-flex justify-content-center align-items-center mode_choice_10_div text-center" id="mode_choice_10_div">
                                    <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_10" id="mode_choice_10" style="display: none;">
                                        <option value="C58">LENGVAS</option>
                                        <option value="C80">LENGVAS SU DISTRAKTORIUMI</option>
                                        <option value="C59">VIDUTINIS</option>
                                        <option value="C81">VIDUTINIS SU DISTRAKTORIUMI</option>
                                        <option value="C60">SUNKUS</option>
                                        <option value="C82">SUNKUS SU DISTRAKTORIUMI</option>
                                    </select>
                                </div>
                            </div>

                            <div class="rasyba-options-row">
                                <div class="mode_choice_11_div" id="mode_choice_11_div" style="display: none;">
                                    <label class="rasyba-options-label">
                                        <input type="checkbox" class="r" name="r" value='GALŪNĖS' checked><span class="rasyba-options-label-text" id="rasyba-options-label-text-galune">ŽODŽIO PABAIGA:</span>
                                    </label>
                                    <br>
                                    <div id="galuniu-div">
                                        <label class="rasyba-options-label" style="display: none;">
                                            <input type="checkbox" class="rasyba-options options-for-first-second-classes-input" id="first-second-class-endings" name="rasyba-option" value='{"C61": []}' checked><span class="rasyba-options-label-text">DAIKTAVARDIS</span>
                                            <br>
                                        </label>
                                        <label class="rasyba-options-label options-for-third-fourth-classes" style="display: none;">
                                            <input type="checkbox" class="rasyba-options options-for-third-fourth-classes-input" name="rasyba-option" value='{"C62": []}'><span class="rasyba-options-label-text">DAIKTAVARDŽIAI</span>
                                            <br>
                                        </label>
                                        <label class="rasyba-options-label options-for-third-fourth-classes" style="display: none;">
                                            <input type="checkbox" class="rasyba-options options-for-third-fourth-classes-input" name="rasyba-option" value='{"C63": [], "C64": []}'><span class="rasyba-options-label-text">BŪDVARDŽIAI IR PRIEVEIKSMIAI</span>
                                            <br>
                                        </label>
                                        <label class="rasyba-options-label options-for-third-fourth-classes" style="display: none;">
                                            <input type="checkbox" class="rasyba-options options-for-third-fourth-classes-input" name="rasyba-option" value='{"C65": []}'><span class="rasyba-options-label-text">VEIKSMAŽODŽIAI</span>
                                            <br>
                                        </label>
                                        <div class="mode_choice_12_div" id="mode_choice_12_div">
                                            <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_12" id="mode_choice_12">
                                                <option value="C73">LENGVESNĖS KOMBINACIJOS</option>
                                                <option value="C74">SUNKESNĖS KOMBINACIJOS</option>
                                            </select>
                                        </div>
                                    </div>
                                    <label class="rasyba-options-label">
                                        <input id="C66" type="checkbox" class="rasyba-options" name="rasyba-option" value='{"C66": []}' checked><span class="rasyba-options-label-text">ĮSIDĖMĖTINA RAŠYBA</span>
                                        <br>
                                    </label>
                                    <label class="rasyba-options-label options-for-third-fourth-classes" style="display: none;">
                                        <input type="checkbox" class="rasyba-options options-for-third-fourth-classes-input" name="rasyba-option" value='{"C71": []}'><span class="rasyba-options-label-text">PRIEBALSIŲ SUPANAŠĖJIMAS</span>
                                        <br>
                                    </label>
                                    <label class="rasyba-options-label options-for-first-second-classes" style="display: block;">
                                        <input type="checkbox" class="rasyba-options options-for-first-second-classes-input" name="rasyba-option" value='{"C67": []}'checked><span class="rasyba-options-label-text">PANAŠIAI SKAMBANČIOS PRIEBALSĖS</span>
                                        <br>
                                    </label>
                                    <label class="rasyba-options-label" style="display: block;">
                                        <input type="checkbox" class="rasyba-options" name="rasyba-option" value='{"C68": []}' checked><span class="rasyba-options-label-text">BALSĖS IR DVIBALSĖS</span>
                                        <br>
                                    </label>
                                    <label class="rasyba-options-label options-for-third-fourth-classes" style="display: none;">
                                        <input type="checkbox" class="rasyba-options options-for-third-fourth-classes-input" name="rasyba-option" value='{"C72": []}'><span class="rasyba-options-label-text">MIŠRIEJI DVIGARSIAI</span>
                                        <br>
                                    </label>
                                    <label class="rasyba-options-label options-for-third-fourth-classes" style="display: none;">
                                        <input type="checkbox" class="rasyba-options options-for-third-fourth-classes-input" name="rasyba-option" value='{"C69": []}'><span class="rasyba-options-label-text">PRIEŠDĖLIAI</span>
                                        <br>
                                    </label>
                                    <label class="rasyba-options-label options-for-third-fourth-classes" style="display: none;">
                                        <input type="checkbox" class="rasyba-options options-for-third-fourth-classes-input" name="rasyba-option" value='{"C70": []}'><span class="rasyba-options-label-text">PRIESAGOS</span>
                                        <br>
                                    </label>
                                </div>

                                <div class="mode_choice_13_div">
                                    <div class="row"></div>
                                    <div class="col-12 d-flex justify-content-center align-items-center mode_choice_13_div text-center" id="mode_choice_13_div">
                                        <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_13" id="mode_choice_13" style="display: none;">
                                            <option value="3">RETESNI ATVEJAI</option>
                                            <option value="1">DAŽNESNI ATVEJAI</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="modeChoice4_div">
                                <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="modeChoice4" id="mode_choice_4" style="display: block;">
                                    <option value="C40">NUSTATYTI VEIKSMŲ KIEKĮ</option>
                                    <option value="C39">NUSTATYTI LAIKO TRUKMĘ</option>
                                </select>
                            </div>

                            <div class="timer-question-number-div">
                            <div class="timer-input-div" id="timer-input-div" style="display: none;">
                                <div class="input-group">
                                    <div class="input-wrapper">
                                        <button class="control-btn" 
                                                onmousedown="startHold('timer-input', 1, 60, false)"
                                                onmouseup="stopHold()"
                                                onmouseleave="stopHold()"
                                                ontouchstart="event.preventDefault(); startHold('timer-input', 1, 60, false)"
                                                ontouchend="stopHold()"
                                                ontouchcancel="stopHold()">−</button>
                                        <input type="number" class="timer-input" id="timer-input" min="1" max="60" step="1" value="5" readonly>
                                        <button class="control-btn" 
                                                onmousedown="startHold('timer-input', 1, 60, true)"
                                                onmouseup="stopHold()"
                                                onmouseleave="stopHold()"
                                                ontouchstart="event.preventDefault(); startHold('timer-input', 1, 60, true)"
                                                ontouchend="stopHold()"
                                                ontouchcancel="stopHold()">+</button>
                                    </div>
                                    <h3 class="timer-choice-label">minutes</h3>
                                </div>
                            </div>
                            <div class="question-number-input-div" id="question-number-input-div">
                                <div class="input-group">
                                    <div class="input-wrapper">
                                        <button class="control-btn" 
                                                onmousedown="startHold('question-number-input', 1, 200, false)"
                                                onmouseup="stopHold()"
                                                onmouseleave="stopHold()"
                                                ontouchstart="event.preventDefault(); startHold('question-number-input', 1, 200, false)"
                                                ontouchend="stopHold()"
                                                ontouchcancel="stopHold()">−</button>
                                        <input type="number" class="question-number-input" id="question-number-input" min="1" max="200" step="1" value="20" readonly>
                                        <button class="control-btn" 
                                                onmousedown="startHold('question-number-input', 1, 200, true)"
                                                onmouseup="stopHold()"
                                                onmouseleave="stopHold()"
                                                ontouchstart="event.preventDefault(); startHold('question-number-input', 1, 200, true)"
                                                ontouchend="stopHold()"
                                                ontouchcancel="stopHold()">+</button>
                                    </div>
                                    <h3 class="answer-number-label">veiksmų</h3>
                                </div>
                            </div>
                            </div>
                        </div>
                    </div>
				</div>
            <div class="submit-button-div">
                <div class="earnings-estimation-outer">
                <button class="earnings-estimation-display info-button custom-coin-amount"
                    onclick="openObjectPopup(infoMessages['coin-amount-custom'].content, infoMessages['coin-amount-custom'].title, infoMessages['coin-amount-custom'].subtitle)">
                    <div class="potetnital-earnings-amount-and-info-holder">
                        <span class="potetnital-earnings-coin-icon-and-amount-holder">
                        <span class="earnings-iki-holder custom-earnings-iki-holder">
                        </span>
                        <span class="coin-icon">
                                <img src="../images/icons/icon-sudedu-coin.png">
                        </span>
                        <span class="coin-amount"></span>
                        </span>
                        <div 
                            class="info-icon"
                            >
                        <svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 256 256" xml:space="preserve">
                        <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)">
                            <path d="M 49.083 71.489 l 5.776 -21.96 l 4.186 -15.247 c 3.497 -16.18 -32.704 -2.439 -38.002 1.695 l 0.425 4.853 c 4.824 -3.395 23.091 -7.744 19.449 4.275 l -1.634 6.135 l 0 0 l -8.329 31.071 c -3.497 16.18 32.704 2.439 38.002 -1.695 l -0.425 -4.853 C 63.708 79.159 45.441 83.508 49.083 71.489 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>
                            <circle cx="53.871" cy="11.201" r="11.201" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>
                        </g>
                        </svg>
                        </div>
                    </div>
                </button>
            </div>

                <div class="submit-button-outer">
				    <button class="submit-button">Pradėti</button>
                </div>
			</div>
            </div>
            <div class="message-board-personal-chl-container">

            <div class="message-board-container">
                <div class="board-header">
                    <div class="board-title">Naujienos</div>
                    <div class="board-date" id="currentDate"></div>
                </div>
                <div class="message-board hide-scrollbar" id="messageBoard">
                    <!-- Messages will be inserted here -->
                </div>
            </div>
            
            <div class="personal-chl-container">
                <div class="practice-label">IŠŠŪKIAI</div>
                
                <div class="personal-chl-content-holder">
                    <div class="chl-pills-container" id="chlPills"></div>
                    <div class="chl-content-container" id="chlContentContainer"></div>
                </div>
            </div>
			</div>
            </div>
		</div>


	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="../parameter_dictionary.js"></script>
	<script src="../mental-arithmetic.js"></script>
	<script src="../mental-arithmetic-combinations.js"></script>
    <script src="../main-nav-bar.js"></script>
	<script src="matematika_options.js"></script>

	<script>
        let userClass;

		function submitSelection() {
            resetControllerTaskSettings();
			let modeChoiceSelection = document.querySelector('#mode_choice').value;
			if (localStorage.getItem('controller') !== null) {
				controller = JSON.parse(localStorage.getItem('controller'))
			}

			if (modeChoiceSelection === "math") {
				controller.mode = 'math';
			} else if (modeChoiceSelection === "lang") {
				controller.mode = 'lang';
			}

			controller.language = "LT";

			if (controller.mode === "math") {
				modeChoice1Selection = modeChoice1Element.value;
				modeChoice2Selection = modeChoice2Element.value;
				selectedNumbers = [selectedNumberElement.value, selectedNumber2Element.value].sort();
				modeChoice3Selection = modeChoice3Element.value;
				modeChoice5Selection = modeChoice5Element.value;
				modeChoice6Selection = modeChoice6Element.value;
				modeChoice7Selection = modeChoice7Element.value;

				var checkbox = document.getElementById("remainder-input");

				controller.modeChoice1 = modeChoice1Selection;
				controller.modeChoice2 = modeChoice2Selection;
				controller.selectedNumbers = selectedNumbers;
				controller.withRemainder = checkbox.checked;
				if (modeChoice3Selection === "C37") {
					controller.modeChoice3 = true;
				} else if (modeChoice3Selection === "C38") {
					controller.modeChoice3 = false;
				}
				controller.modeChoice5 = modeChoice5Selection;
				controller.modeChoice6 = modeChoice6Selection;
				controller.modeChoice7 = modeChoice7Selection;
				controller.modeChoice8 = 'C79';
				controller.result = ['', '', '', '', '']
				controller.task = null;

			} else if (controller.mode === "lang") {
				const modeChoice8Value = document.querySelector('#mode_choice_8').value;
				const rasybaOptions = document.querySelectorAll('[name="rasyba-option"]');
				let anyChecked = false;
				rasybaOptions.forEach(option => {
				if (option.checked) {
					anyChecked = true;
				}
				});
			if ((modeChoice8Value === "rasyba" && anyChecked) || modeChoice8Value !== "rasyba") {
				modeChoice8Selection = modeChoice8Element.value;
				modeChoice9Selection = modeChoice9Element.value;
				modeChoice12Selection = modeChoice12Element.value;
				modeChoice13Selection = modeChoice13Element.value;
				classChoiceSelection = classChoiceElement.value;

				controller.classChoice = classChoiceSelection;
				controller.modeChoice1 = modeChoice8Selection;
				
				controller.modeChoice2 = modeChoice9Selection;

				controller.modeChoice3 = getSelectedRasybaConditions();
				controller.modeChoice5 = modeChoice12Selection;
				controller.result = ['', '', '', '', ''];
				controller.modeChoiceLtDifficulty = document.getElementById('mode_choice_10').value;
				if (controller.classChoice === "C75") {
					controller.questionFrequency = Number(modeChoice13Selection);
				} else {
					controller.questionFrequency = 1;
				}
			}
		}
        	controller.modeChoice4 = modeChoice4Element.value
			localStorage.setItem('controller', JSON.stringify(controller))

			if (controller.modeChoice4 === "C39") {
				startQuestionsTimer()
			} else if (controller.modeChoice4 = "C40") {
				startQuestionsNumber()
			}
		}

		let submitButtonElement = document.querySelector('.submit-button');
		submitButtonElement.addEventListener("click", submitSelection);

		window.onload = function () {
            const savedController = localStorage.getItem('controller');
            if (savedController) {
                controller = JSON.parse(savedController);
            }
            if (controller) {
                controller.task = null;
                controller.taskCompleted = false;
                localStorage.setItem('controller', JSON.stringify(controller));
            }

            if (!userData || userData.accType === "teacher") {
                document.querySelectorAll('.earnings-estimation-outer').forEach(el => {
                    el.style.display = 'none';
                });
                document.querySelector(".submit-button-outer").style.justifyContent = "center";
            } else {
                updateControllerCustomTaskChoices();
                displayCustomTaskPotentialEarnings();
            }

            if (userData?.accType === "teacher") {
                document.querySelector(".personal-chl").style.display = "none";
            }
            
			document.querySelector('#template-container').removeAttribute('hidden');
		};

		window.addEventListener("pageshow", function() {
    var selects = document.querySelectorAll('select');
    selects.forEach(function(select) {
        var selectedOption = select.querySelector('[selected]');
        var selectedIndex = selectedOption ? Array.from(select.children).indexOf(selectedOption) : 0;
        select.selectedIndex = selectedIndex;
    });

    var checkbox = document.getElementById('remainder-input');
    if (checkbox) {
        checkbox.checked = false; // Deselect the checkbox
    }
});

	if (localStorage.getItem('controller') !== null) {
	controller = JSON.parse(localStorage.getItem('controller'));
	controller.language = "LT";
	localStorage.setItem('controller', JSON.stringify(controller));
}


//POPUP SCRIPT START

// Function to set value in localStorage with expiration
function setClassLocalStorage(classValue) {
    const now = new Date();
    // Set expiration to 2 months from now
    const expiration = new Date(now.setMonth(now.getMonth() + 2));
    
    const item = {
        value: classValue,
        expiration: expiration.getTime()
    };
    
    localStorage.setItem("userClassNotLoggedIn", JSON.stringify(item));
}

// Function to get value from localStorage and check expiration
function getClassLocalStorage() {
    const itemStr = localStorage.getItem("userClassNotLoggedIn");
    
    // If the item doesn't exist, return null
    if (!itemStr) {
        return null;
    }
    
    const item = JSON.parse(itemStr);
    const now = new Date();
    
    // Compare the expiration time with the current time
    if (now.getTime() > item.expiration) {
        // If the item is expired, delete it and return null
        localStorage.removeItem("userClassNotLoggedIn");
        return null;
    }
    
    return item.value;
}

// Function to show the class popup
function showClassPopup() {
    const popup = document.getElementById('classPopup');
    const nextButton = document.getElementById('classPopupButton');
    let selectedClass = null;
    
    popup.classList.add('active');
    document.body.classList.add('popup-active');
    
    // Add event listeners to class options
    const classOptions = document.querySelectorAll('.class-option');
    classOptions.forEach(option => {
        option.addEventListener('click', function() {
            // Remove selected class from all options
            classOptions.forEach(opt => opt.classList.remove('selected'));
            // Add selected class to clicked option
            this.classList.add('selected');
            
            // Store the selected class
            selectedClass = Number(this.getAttribute('data-class'));
            
            // Enable the Next button
            nextButton.disabled = false;
        });
    });
    
    // Add event listener to Next button
    nextButton.addEventListener('click', function() {
        if (selectedClass !== null && selectedClass !== undefined) {
            // Set localStorage with selected class and expiration
            setClassLocalStorage(selectedClass);

            userClass = selectedClass;

            if (userData) {
                updateUserClass (userClass);
                userData.knowledgeLvl = userClass;
                localStorage.setItem('userData', JSON.stringify(userData));
            }
            
            // Close popup
            popup.classList.remove('active');
            document.body.classList.remove('popup-active');

            displayPersonalChl();
        }
    });
}

async function updateUserClass (userClassSelection) {
    try {
        const response = await apiFetch(apiBase + `students/knowledge-level`, {
            method: "PATCH",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                studentId: userData.userId,
                knowledgeLvl: Number(userClassSelection)
            })
        });

        if (!response) {
            return;
        }

        if (!response.ok) {
            throw new Error("Nepavyko atnaujinti lygio");
        }

        const data = await response.json();
    } catch (error) {
        console.error("Error updating knowledge level:", error);
    }
}

//POPUP SCRIPT END
      
const messagesToUsers = [
            {   
                title: "Naujos Užduotys",
                text: "Šią savaitę pridėjome naujų užduočių visoms klasėms.",
                fullText: "Šią savaitę pridėjome naujų užduočių visoms klasėms. Ačiū už jūsų atsiliepimus! Dabar galite rasti daugiau užduočių skaitmeninėje lygybėje, teksto supratime ir rašybos pratybose. Nuolat tobuliname turinį pagal jūsų poreikius.",
                date: "2025-01-20"
            },
            {
                title: "Priminimas",
                text: "Primename: reguliari praktika pagerina rezultatus.",
                fullText: "Primename: reguliari praktika pagerina rezultatus. Rekomenduojame praktikuotis 15-20 minučių kasdien. Tyrimai rodo, kad nuoseklus mokymasis yra efektyvesnis nei ilgi, bet reti pratybų seansai. Sukurkite savo rutiną ir stebėkite savo pažangą!",
                date: "2025-01-18"
            },
            {
                title: "Nuaja Funkcija",
                text: "Naujas funkcionalumas: dabar galite sekti savo pažangą per laiką.",
                fullText: "Naujas funkcionalumas: dabar galite sekti savo pažangą per laiką. Žiūrėkite statistikos skiltį ir analizuokite, kuriose srityse jums sekasi geriausiai, o kur galite tobulėti. Grafikais vaizduojami jūsų rezultatai padės geriau suprasti savo mokymosi kelią.",
                date: "2025-01-15"
            }
        ];

function displayMessages () {
    const messageBoard = document.getElementById('messageBoard');
    const currentDateEl = document.getElementById('currentDate');

    // Set current date
    const today = new Date();
    const dateStr = today.toLocaleDateString('lt-LT', { 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
    });
    currentDateEl.textContent = dateStr;

    // Populate messages
    if (messagesToUsers.length > 0) {
        messagesToUsers.forEach(msg => {
            const messageEl = document.createElement('div');
            messageEl.className = 'board-message';
            
            const msgDate = new Date(msg.date);
            const formattedDate = msgDate.toLocaleDateString('lt-LT', { 
                month: 'short', 
                day: 'numeric' 
            });
            
            messageEl.innerHTML = `
                ${msg.text}
                <div class="message-meta">${formattedDate}</div>
            `;


            messageEl.addEventListener('click', () => openObjectPopup(msg.fullText, msg.title, msg.date) );
            messageBoard.appendChild(messageEl);
        });
    } else {
        messageBoard.innerHTML = '<div class="empty-message">Naujienų nėra!</div>';
    }
}

displayMessages();

const timerInputElement = document.querySelector('#timer-input');
const questionNumberInputElement = document.querySelector('#question-number-input');

const personalChlDict = {
    0: {
        "math": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "text-comp": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "grammar": [
            '["lang","C75","C50","1",{"C61":[],"C66":["2kl"],"C67":[],"C68":[]},"C40","C73","C58",3,"1"]'
        ]
    },
    1: {
        "math": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "text-comp": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "grammar": [
            '["lang","C75","C50","1",{"C61":[],"C66":["2kl"],"C67":[],"C68":[]},"C40","C73","C58",3,"1"]'
        ]
    },
    2: {
        "math": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "text-comp": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "grammar": [
            '["lang","C75","C50","1",{"C61":[],"C66":["2kl"],"C67":[],"C68":[]},"C40","C73","C58",3,"1"]'
        ]
    },
    3: {
        "math": [
            '[["math","C7","C36","","C41","C45","C47",["1","1"],false,"C79"], ["C40","50"]]'
        ],
        "text-comp": [
            '[["lang","C75","C49","C51","C58"], ["C40","1"]]'
        ],
        "grammar": [
            '[["lang","C75","C83","C50",{"C61":[],"C66":["2kl"],"C67":[],"C68":[]},"C73",3], ["C40","1"]]'
        ]
    },
    4: {
        "math": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "text-comp": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "grammar": [
            '["lang","C75","C50","1",{"C61":[],"C66":["2kl"],"C67":[],"C68":[]},"C40","C73","C58",3,"1"]'
        ]
    },
}

const typeLabels = {
    "math": "Matematika",
    "text-comp": "Teksto supratimas",
    "grammar": "Gramatika"
};

function displayPersonalChl() {
    const container = document.getElementById('personalChlContainer');
    const userClass = userData?.knowledgeLvl || getClassLocalStorage() || 2;

    if (!personalChlDict[userClass]) {
        container.innerHTML = '<p style="text-align: center; color: rgba(0,0,0,0.5);">Nėra prieinamų iššūkių</p>';
        return;
    }

    const classData = personalChlDict[userClass];
    const challenges = Object.keys(classData).map(key => {
        const items = classData[key];
        const randomItem = JSON.parse(items[Math.floor(Math.random() * items.length)]);
        const randomItemInfo = getOptionTextFromValues(randomItem[0], randomItem[1]);

        return {
            type: key,
            chl: randomItem[0],
            duration: randomItem[1],
            chlInfo: randomItemInfo
        };
    });

    const pillsContainer = document.getElementById('chlPills');
    const contentContainer = document.getElementById('chlContentContainer');

    challenges.forEach((challenge, index) => {
        // Filter out unwanted items
        const filteredInfo = challenge.chlInfo.filter(item =>
            !item.includes('KLASĖ') &&
            !item.includes('KOMBINACIJOS') &&
            !item.includes('ATVEJAI')
        );

        // Process all items as regular items
        const processedItems = [];
        filteredInfo.forEach(item => {
            if (item.includes("<li>")) {
                const splitItems = item.split("<li>")
                splitItems.forEach(splitItem => {
                    if (splitItem.includes("</li>")) {
                        const splitItemProcessed = splitItem.split("</li>")[0]
                        processedItems.push({ type: 'regular', content: splitItemProcessed })
                    }
                });
            } else {
                processedItems.push({ type: 'regular', content: item })
            }
        });

        if (processedItems.some(i => i.content === "TEKSTO SUPRATIMAS" || i.content === "GRAMATIKA")) {
            processedItems.shift();
        }

        const pill = document.createElement('button');
        pill.className = `chl-pill ${index === 0 ? 'active' : ''}`;
        pill.textContent = typeLabels[challenge.type];
        pill.dataset.index = index;
        pill.addEventListener('click', () => switchTab(index));
        pillsContainer.appendChild(pill);

        const content = document.createElement('div');
        content.className = `chl-content ${index === 0 ? 'active' : ''}`;

        // Title
        const title = document.createElement('div');
        title.className = 'chl-title';
        title.textContent = typeLabels[challenge.type];

        // Info
        console.log(processedItems)
        const personalChlIInfo = document.createElement('div');
        personalChlIInfo.className = 'chl-info';
        personalChlIInfo.textContent = processedItems.map(item => item.content).join(' • ');

        // Button
        const personalChLButton = document.createElement('button');
        personalChLButton.className = 'chl-action-button';
        personalChLButton.textContent = 'Atlikti';
        personalChLButton.addEventListener('click', () => completePersonalChlTask(challenge.chl, challenge.duration));

        const titleHodler = document.createElement('div');
        titleHodler.className = 'chl-title-holder';
        titleHodler.appendChild(title)

        if (userData && userData.knowledgeLvl) {
            const potentialEarningsDisplay = document.createElement('div');

            let answeringMode = challenge.duration[0];
            let numberOfQuestions = challenge.duration[1];
            let earningsDiplay = "";

            if (answeringMode === "C39") {
                earningsDiplay = `
                    <div class="earnings-estimation-outer">
                        <button class="earnings-estimation-display info-button"
                            onclick="openObjectPopup(infoMessages['coin-amount-custom-timer'].content, infoMessages['coin-amount-custom-timer'].title, infoMessages['coin-amount-custom-timer'].subtitle)">
                            <div class="potetnital-earnings-amount-and-info-holder">
                                <span class="potetnital-earnings-coin-icon-and-amount-holder">
                                <span class="earnings-iki-holder">
                                    x
                                </span>
                                <span class="coin-icon">
                                        <img src="../images/icons/icon-sudedu-coin.png">
                                </span>
                                <span class="coin-amount">${Number((calculateTasksPerCorrectAnswerPoints(challenge.chl, challenge)*personalChlCoinBonusModifier).toFixed(2))}</span>
                                </span>
                                <div 
                                    class="info-icon"
                                    >
                                <svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 256 256" xml:space="preserve">
                                <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)">
                                    <path d="M 49.083 71.489 l 5.776 -21.96 l 4.186 -15.247 c 3.497 -16.18 -32.704 -2.439 -38.002 1.695 l 0.425 4.853 c 4.824 -3.395 23.091 -7.744 19.449 4.275 l -1.634 6.135 l 0 0 l -8.329 31.071 c -3.497 16.18 32.704 2.439 38.002 -1.695 l -0.425 -4.853 C 63.708 79.159 45.441 83.508 49.083 71.489 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>
                                    <circle cx="53.871" cy="11.201" r="11.201" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>
                                </g>
                                </svg>
                                </div>
                            </div>
                        </button>
                    </div>
                    `
            } else if (answeringMode === "C40") {
                earningsDiplay = `
                    <div class="earnings-estimation-outer">
                        <button class="earnings-estimation-display info-button"
                            onclick="openObjectPopup(infoMessages['coin-amount-custom-question-number'].content, infoMessages['coin-amount-custom-question-number'].title, infoMessages['coin-amount-custom-question-number'].subtitle)">
                            <div class="potetnital-earnings-amount-and-info-holder">
                                <span class="potetnital-earnings-coin-icon-and-amount-holder">
                                <span class="earnings-iki-holder">
                                    IKI
                                </span>
                                <span class="coin-icon">
                                        <img src="../images/icons/icon-sudedu-coin.png">
                                </span>
                                <span class="coin-amount">${Number((calculateTasksPerCorrectAnswerPoints(challenge.chl) * numberOfQuestions * personalChlCoinBonusModifier).toFixed(2))}</span>
                                </span>
                                <div 
                                    class="info-icon"
                                    >
                                <svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 256 256" xml:space="preserve">
                                <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)">
                                    <path d="M 49.083 71.489 l 5.776 -21.96 l 4.186 -15.247 c 3.497 -16.18 -32.704 -2.439 -38.002 1.695 l 0.425 4.853 c 4.824 -3.395 23.091 -7.744 19.449 4.275 l -1.634 6.135 l 0 0 l -8.329 31.071 c -3.497 16.18 32.704 2.439 38.002 -1.695 l -0.425 -4.853 C 63.708 79.159 45.441 83.508 49.083 71.489 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>
                                    <circle cx="53.871" cy="11.201" r="11.201" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>
                                </g>
                                </svg>
                                </div>
                            </div>
                        </button>
                    </div>
                    `
            }

            potentialEarningsDisplay.innerHTML = earningsDiplay
            
            titleHodler.appendChild(potentialEarningsDisplay);
        }

        
        // Append all elements
        content.appendChild(titleHodler);
        content.appendChild(personalChlIInfo);
        content.appendChild(personalChLButton);

        contentContainer.appendChild(content);
    });
}

function switchTab(index) {
    const pills = document.querySelectorAll('.chl-pill');
    const contents = document.querySelectorAll('.chl-content');

    pills.forEach((pill, i) => {
        pill.classList.toggle('active', i === index);
    });

    contents.forEach((content, i) => {
        content.classList.toggle('active', i === index);
    });
}

function completePersonalChlTask(challengeInfo, challengeDuration) {
    const parsedCurrentTaskInstructions = challengeInfo;
    const currentTaskDuration = challengeDuration

    if (localStorage.getItem('controller') !== null) {
        controller = JSON.parse(localStorage.getItem('controller'))
    }

    var checkbox = document.getElementById("remainder-input");

    controller.language = "LT";
        if (parsedCurrentTaskInstructions[0] === "math") {
        controller.mode = 'math';
        controller.modeChoice1 = parsedCurrentTaskInstructions[1];
        controller.modeChoice2 = parsedCurrentTaskInstructions[2];
        controller.modeChoice3 = parsedCurrentTaskInstructions[3];
        controller.modeChoice5 = parsedCurrentTaskInstructions[4];
        controller.modeChoice6 = parsedCurrentTaskInstructions[5];
        controller.modeChoice7 = parsedCurrentTaskInstructions[6];
        controller.selectedNumbers = parsedCurrentTaskInstructions[7];
        controller.withRemainder = parsedCurrentTaskInstructions[8];
        controller.modeChoice8 = parsedCurrentTaskInstructions[9];
        controller.task = ["personalChl", null];
        controller.taskCompleted = false;

        controller.modeChoice4 = currentTaskDuration[0];
        controller.setTaskDuration = currentTaskDuration[1];

    } else if (parsedCurrentTaskInstructions[0] === "lang") {
        controller.mode = 'lang';
        if (parsedCurrentTaskInstructions[2] === "C49") {
            controller.classChoice = parsedCurrentTaskInstructions[1];
            controller.modeChoice1 = parsedCurrentTaskInstructions[2];
            controller.modeChoice2 = parsedCurrentTaskInstructions[3];
            controller.modeChoiceLtDifficulty = parsedCurrentTaskInstructions[4];

            controller.task = ["personalChl", null];
            controller.taskCompleted = false;
            
            controller.modeChoice4 = currentTaskDuration[0];
            controller.setTaskDuration = currentTaskDuration[1];

        } else if (parsedCurrentTaskInstructions[2] === "C83") {
            if (parsedCurrentTaskInstructions[3] === "C50") {
                controller.classChoice = parsedCurrentTaskInstructions[1];
                controller.modeChoice1 = parsedCurrentTaskInstructions[2];
                controller.modeChoice2 = parsedCurrentTaskInstructions[3];
                controller.modeChoice3 = parsedCurrentTaskInstructions[4];
                controller.modeChoice5 = parsedCurrentTaskInstructions[5];
                controller.questionFrequency = parsedCurrentTaskInstructions[6];
                
                controller.task = ["personalChl", null];
                controller.taskCompleted = false;

                controller.modeChoice4 = currentTaskDuration[0];
                controller.setTaskDuration = currentTaskDuration[1];
            }
        }
    }

    localStorage.setItem('controller', JSON.stringify(controller))

    startQuestions();
}

function checkWrap() {
  const middleDivEl = document.querySelector('.middle-div');
  const containerInnerEl = document.querySelector('.container-inner');
  const practiceHolderDiv = document.querySelector(".practice-outer-div");
  const messageBoardPersonalChlHolderDiv = document.querySelector(".message-board-personal-chl-container");

  if (!middleDivEl || !containerInnerEl || !practiceHolderDiv || !messageBoardPersonalChlHolderDiv) return;

  // Defer measurement until after layout settles
  requestAnimationFrame(() => {
    // Remove wrapped first to re-measure cleanly
    middleDivEl.classList.remove('wrapped');
    containerInnerEl.classList.remove('wrapped');

    // Recalculate after class removal
    const wrapped = messageBoardPersonalChlHolderDiv.offsetTop > practiceHolderDiv.offsetTop;

    // Toggle classes accordingly
    middleDivEl.classList.toggle('wrapped', wrapped);
    containerInnerEl.classList.toggle('wrapped', wrapped);

    // Handle height adjustment
    if (wrapped) {
      setTimeout(setProperHeight, 50);
    } else {
      practiceHolderDiv.style.height = "100%";
    }
  });
}

function setProperHeight() {
  const middleDiv = document.querySelector('.middle-div');
  const outer = document.querySelector('.practice-outer-div');
  
  if (!middleDiv || !outer) return;

  // Only run if wrapped
  if (!middleDiv.classList.contains('wrapped')) return;

  // Reset height to auto first
  outer.style.height = 'auto';

  // Force reflow
  outer.offsetHeight;

  // Use requestAnimationFrame for accurate measurement
  requestAnimationFrame(() => {
    const container = document.getElementById('new-task-options-container-inner');
    if (!container) return;

    const fullHeight = container.scrollHeight;
    const practiceLabel = outer.querySelector('.practice-label-div');
    const submitButton = outer.querySelector('.submit-button-div');
    
    // Calculate total needed height
    const labelHeight = practiceLabel ? practiceLabel.offsetHeight : 0;
    const buttonHeight = submitButton ? submitButton.offsetHeight : 0;
    const padding = 40; // padding from .practice-outer-div
    
    const totalHeight = fullHeight + labelHeight + buttonHeight + padding;
    
    outer.style.height = totalHeight + 20 + 'px';
    
    // Update overflow class after height is set
    setTimeout(updateOverflowClass, 50);
  });
}

window.addEventListener('resize', checkWrap);

function updateOverflowClass() {
  const container = document.getElementById('new-task-options-container-inner');
  const practiceDiv = document.querySelector('.practice-outer-div');
  if (!container || !practiceDiv) return;

  // Compare scrollHeight to offsetHeight (visible height)
  const isOverflowing = container.scrollHeight > container.offsetHeight;
  practiceDiv.classList.toggle('overflowing', isOverflowing);
}

// Run on load, resize, and DOM changes
window.addEventListener('load', updateOverflowClass);
window.addEventListener('resize', updateOverflowClass);

// Optional: detect dynamic content changes
const observer = new MutationObserver(updateOverflowClass);
observer.observe(document.getElementById('new-task-options-container-inner'), { childList: true, subtree: true });


window.addEventListener('resize', checkWrap);
window.addEventListener('load', checkWrap);

function handleKnowledgeLvlStatus () {
    const knowledgeLvlStatus = getClassLocalStorage();
    console.log()
    if ((userData && userData.knowledgeLvl) || (knowledgeLvlStatus !== null && knowledgeLvlStatus !== undefined)) {
        displayPersonalChl();
    } else {
        showClassPopup();
    }
}

handleKnowledgeLvlStatus();

// LOCAL STORAGE LIMIT START

const LOCALSTORAGE_LIMIT = 5 * 1024 * 1024;

let totalBytes = 0;
for (let i = 0; i < localStorage.length; i++) {
    const key = localStorage.key(i);
    const value = localStorage.getItem(key);
    totalBytes += key.length + value.length; // characters
}
totalBytes *= 2;

const percentUsed = (totalBytes / LOCALSTORAGE_LIMIT) * 100;

console.log(`LocalStorage used: ${percentUsed.toFixed(2)}% of 5 MB`);

// LOCAL STORAGE LIMIT END

	</script>
</body>

</html>
