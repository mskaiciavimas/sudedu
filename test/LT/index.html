<!DOCTYPE html>
<html>

<head>
	<title>sudedu LT</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="sudEdu skirtas priešmokyklinio ugdymo, pradinių bei aukštesnių klasių mokinių aritmetinių veiksmų (sudėties, atimties, daugybos, dalybos) mintinio skaičiavimo, teksto supratimo bei rašymo gebėjimų gilinimui. Skaičiavimas mintinai ne tik lavina atmintį, bet ir lengvina bei spartina matematikos mokymąsi. Skaitymo supratimas šiandien itin svarbus, nes jis suteikia galimybę atsirinkti ir kritiškai vertinti gausią informaciją, padeda orientuotis informacijos sraute bei išskirti patikimus šaltinius, kad galėtume priimti pagrįstus sprendimus."> 
	<meta name="keywords" content="mintinis skaičiavimas, mintinas skaičiavimas, skaičiavimas mintinai, matematika, pradinukai, priešmokyklinis ugdymas, priešmokyklinukai, pradinis ugdymas, atminties lavinimas, skaitinė lygybė, skaitinė lygybė su nežinomuoju, sudėtis, dėmuo, atimtis, turinys, atėminys, daugyba, dauginamasis, daugiklis, dalyba, dalinis, daliklis, daugybos lentelė, lentelinė sudėtis, lentelinė atimtis, sudėtis iki 10, sudėtis iki 20, sudėtis iki 100, sudėtis iki 1000, atimtis iki 10, atimtis iki 20, atimtis iki 100, atimtis iki 1000, vienaženkliai skaičiai, dviženkliai skaičiai, triženkliai skaičiai, keturženkliai skaičiai, peržengiant dešimtį, peržengiant šimtą, peržengiant tūkstančių vienetus, išardant dešimtį, išardant šimtą, išardant tūkstančių vienetus, pergrupuojant dešimtis, pergrupuojant šimtus, peržengiant tūkstančių vienetus, skaitymas, teksto supratimas, skaitymo supratimas, rašymas, struktūros išdėstymas, turinio komponavimas, įsidėmėtina rašyba, raidė, raidės, balsė, balsės, dvibalsė, dvibalsės, priebalsė, priebalsės, panašiai skambančios priebalsės, mišrusis dvigarsis, mišrieji dvigarsiai, priešdėlis, priešdėliai, priesaga, priesagos, galūnė, žodžio galūnė, žodžio pabaiga, daiktavardis, būdvardis, prieveiksmis, veiksmažodis, daiktavardžiai, būdvardžiai, prieveiksmiai, veiksmažodžiai">
	
	<link rel="canonical" href="https://www.sudedu.lt/LT/">
	<link rel="alternate" href="https://www.sudedu.lt/LT/" hreflang="lt">
	<link rel="alternate" href="https://www.sudedu.lt/EN/" hreflang="en">
	<link rel="icon" href="../images/favicon.ico" type="image/x-icon">
	<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" type="text/css" href="../index.css">
    <link rel="stylesheet" href="../main-nav-bar.css">

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-96Q83PW8XY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-96Q83PW8XY');
</script>	
<script src="../refresh-token.js"></script>

<style>
	* {
		-webkit-user-select: none;
		-webkit-tap-highlight-color: transparent;
		user-select: none;
        box-sizing: border-box;
	}

	html {
		display: flex;
		justify-content: center;
		align-items: center;
		background-image: linear-gradient(to top, #ffbf9c, #ffbf92, #ffbf89, #ffbf7e, #ffc074);
		width: 100vw;
		height: 100svh;
		overflow: hidden;
		user-select: none;         /* Standard */
		-webkit-user-select: none; /* Chrome, Safari, Edge */
		-moz-user-select: none;    /* Firefox */
		-ms-user-select: none;     /* IE/older Edge */
	}

	body {
		margin: 0;
		font-family: 'SFpro', sans-serif;
		display: flex;
		flex-direction: column;
		align-items: center;
		width: 100%;
		height: 100%;
		overflow: hidden;
	}

	.container {
		position: relative;
		height: calc(100% - 80px - 16px - 16px);
		max-height: calc(100% - 80px - 16px - 16px);
		min-height: calc(100% - 80px - 16px - 16px);
		width: calc(100% - 16px - 16px);
		display: flex;
		background: rgba(255, 255, 255, 0.08);
		margin: 16px;
		border-radius: 20px;
		border: 1px solid rgba(255, 255, 255, 0.1);
		box-shadow: 0 8px 40px rgba(0, 0, 0, 0.1);
	}

.container-inner {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
  box-sizing: border-box; /* include padding in height calculations */
  padding: 25px;
  overflow: hidden; /* clip any overflow inside container */
}

.container-inner.wrapped {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
  box-sizing: border-box; /* include padding in height calculations */
  padding: 0px 25px;
  overflow: hidden; /* clip any overflow inside container */
}

.practice-label-div,
.submit-button-div {
  display: flex;
  align-items: center;
  justify-content: center;
   max-width: 500px;
   width: 100%;
}
.submit-button-div {
  padding: 16px 0 0 0;
}

.practice-outer-div {
    position: relative;
    display: flex;
    flex-direction: column;
    height: 100%;
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    padding: 20px;
    border-radius: 25px;
    justify-content: center;
    align-items: center;
}


.personal-chl {
    position: relative;
    display: flex;
    flex-direction: column;
    height: 100%;
    justify-content: end;
}

.practice-outer-div,
.personal-chl {
    flex: 1 1 400px;
    max-width: 50%;
}

.middle-div.wrapped {
    overflow: auto;
    padding: 20px 0;
    gap: 15px;
}

.middle-div.wrapped .practice-outer-div,
.middle-div.wrapped .personal-chl {
    max-width: 100%;
    flex: none;
    width: 100%;
}

.middle-div.wrapped .personal-chl {
    height: auto;
}

.middle-div.wrapped .practice-outer-div.overflowing {
    height: 100%;
}

.middle-div.wrapped .practice-outer-div {
    max-height: 90%;
}

.personal-chl-inner {
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    padding: 20px;
    border-radius: 25px;
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 100%;
}

.middle-div {
  height: 100%;
  display: flex;
  flex-direction: row;
  flex: 1 1 auto;   /* take remaining space */
  min-height: 0;    /* allow shrinking */
  min-width: 0;     /* allow horizontal shrink if needed */
  align-items: start;
  justify-content: center;
  gap: 25px;
  flex-wrap: wrap;
}

.new-task-outer-div {
    display: flex;
    align-items: start;
    justify-content: center;
    overflow: hidden;
    width: 100%;
}

#new-task-options-container {
    max-height: 100%;
    justify-content: start;
    overflow: hidden;
    position: relative;
}

#new-task-options-container-inner {
    display: flex;
    flex-direction: column;
    overflow-y: auto;
    overflow-x: hidden;
    scrollbar-gutter: stable;
    padding: 15px 3px 15px 15px;
    position: relative;
    height: 100%;
    -webkit-overflow-scrolling: touch;
    -webkit-overflow-scrolling: touch !important;
}

#mode_choice {
    margin-top: 0;
}

	.practice-label {
        font-size: 2rem;
        font-weight: 800;
        opacity: 0.9;
        margin-bottom: 16px;
	}

	.lm-animated-bg {
		position: absolute;
		width: 100vw;
		height: auto;
		top: -18px;
		left: -18px;
		right: -18px;
		bottom: -18px;
		background-image: url(../images/main_bg.png);
		background-position: center center;
		background-size: cover;
		background-repeat: no-repeat;
		z-index: -1;
		opacity: 1;
	}

.submit-button {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  border: none;
  /*border: #286D8A 1px solid;*/
  background: linear-gradient(135deg, #3288AC, #286D8A);
  border-radius: 25px;
  cursor: pointer;
  font-size: 1rem;
  color: #F5F5F7;
  overflow: hidden;
  min-width: 0;
  padding: 12px 10px;
  font-weight: 600;
  letter-spacing: 0.01em;
  font-size: 1.15rem;
  width: 150px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  text-transform: uppercase;
  letter-spacing: 0.05rem;
  /*box-shadow: 
        0 1px 2px rgba(0, 0, 0, 0.2),
        0 4px 12px rgba(50, 136, 172, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);*/
}

.submit-button::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.12) 0%, rgba(255, 255, 255, 0) 100%);
  border-radius: 20px;
  pointer-events: none;
  transition: background 0.3s ease;
}

.submit-button::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 20px;
  padding: 1px;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  pointer-events: none;
}

.submit-button:hover::before {
  background: rgba(255, 255, 255, 0.15);
}


	/* POPUP STYLES START */
.class-popup-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    z-index: 10000;
    justify-content: center;
    align-items: center;
}

.class-popup-content {
    background-color: #fff;
    padding: 30px;
    border-radius: 15px;
    box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
    width: 90%;
    max-width: 500px;
    text-align: center;
    position: relative;
}

.class-popup-title {
    font-size: 24px;
    margin-bottom: 20px;
    color: #2c3e50;
    font-weight: bold;
}

.class-options {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
    margin-bottom: 25px;
}

.class-option {
    padding: 12px 20px;
    background-color: #f8f9fa;
    border: 2px solid #dee2e6;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 500;
}

.class-option:hover {
    background-color: #e9ecef;
    transform: translateY(-2px);
}

.class-option.selected {
    background-color: #40c9a9;
    color: white;
    border-color: #40c9a9;
}

.class-popup-note {
    font-size: 14px;
    color: #6c757d;
    margin-top: 15px;
}

/* Make the popup modal visible when needed */
.class-popup-modal.active {
    display: flex;
}

/* Prevent scrolling when popup is active */
body.popup-active {
    overflow: hidden;
}

.class-popup-button {
    padding: 12px 25px;
    background-color: #40c9a9;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 500;
    font-size: 16px;
    transition: all 0.3s ease;
    margin-top: 10px;
}

.class-popup-button:hover {
    background-color: #40c9a9;
    transform: translateY(-2px);
}

.class-popup-button:disabled {
    background-color: #adb5bd;
    cursor: not-allowed;
    transform: none;
}

.personal-chl-list-container {
    display: flex;
    flex-direction: column;
    gap: 15px;
    border-radius: 25px;
    height: 100%;
    overflow-y: auto;
    max-width: 500px;
    align-items: center;
    justify-content: start;
}

.chl-card {
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 25px;
    padding: 10px;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
}

.chl-card:hover::before {
    opacity: 1;
}

.chl-card.expanded {
    background: rgba(255, 255, 255, 0.4);
    padding: 20px;
}

.chl-card.expanded::before {
    opacity: 1;
}

.chl-card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
}

.chl-card-header-left {
    flex: 1;
}

.chl-type-badge {
    display: inline-block;
    padding: 6px 12px;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.chl-type-math {
    background: linear-gradient(135deg, #40c9a9, #32ac93);
    color: white;
}

.chl-type-text-comp {
    background: linear-gradient(135deg, #40c9a9, #32ac93);
    color: white;
}

.chl-type-grammar {
    background: linear-gradient(135deg, #40c9a9, #32ac93);
    color: white;
}

.chl-info-text {
    font-size: 0.95rem;
    color: rgba(0, 0, 0, 0.8);
    line-height: 1.6;
    font-weight: 500;
}

.chl-expand-icon {
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: all 0.3s ease;
    flex-shrink: 0;
}

.chl-expand-icon svg {
    width: 16px;
    height: 16px;
    transition: transform 0.3s ease;
}

.chl-card.expanded .chl-expand-icon svg {
    transform: rotate(180deg);
}

.chl-card-details {
    max-height: 0;
    opacity: 0;
    overflow: hidden;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.chl-label-div {
    width: 100%;
    max-width: 500px;
    display: flex;
    align-items: center;
}

.chl-card.expanded .chl-card-details {
    max-height: 500px;
    opacity: 1;
    margin-top: 15px;
}

.chl-details-info {
    background: rgba(50, 136, 172, 0.08);
    border-left: 4px solid #3288AC;
    padding: 16px;
    border-radius: 12px;
    margin-bottom: 16px;
}

.chl-details-info-item {
    font-size: 0.9rem;
    color: rgba(0, 0, 0, 0.7);
    line-height: 1.8;
    margin-bottom: 6px;
}

.chl-details-info-item:last-child {
    margin-bottom: 0;
}

.chl-details-info-item strong {
    color: rgba(0, 0, 0, 0.9);
    font-weight: 700;
}

.chl-action-button {
    width: 100px;
    padding: 12px 10px;
    border: none;
    background: linear-gradient(135deg, #3288AC, #286D8A);
    color: white;
    font-size: 1rem;
    font-weight: 700;
    letter-spacing: 0.05em;
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 15px;
}

.chl-action-button-holder {
    display: flex;
    justify-content: end;
}

.chl-action-button::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.12) 0%, rgba(255, 255, 255, 0) 100%);
  border-radius: 20px;
  pointer-events: none;
  transition: background 0.3s ease;
}

.chl-action-button::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 20px;
  padding: 1px;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  pointer-events: none;
}

.chl-action-button:hover::before {
  background: rgba(255, 255, 255, 0.15);
}


@media (max-width: 767px) {
	.container {
		width: 100%;
		max-height: calc(100% - 80px);
		min-height: calc(100% - 80px);
		margin: 0;
		background: transparent;
		border: none;
		border-radius: 0;
		padding: 0;
	}

	.container-inner {
		padding: 15px;
	}

    .practice-outer-div {
        width: 70%;
        min-width: 0;
    }

    .chl-card {
        padding: 15px;
    }

    .chl-info-text {
        font-size: 0.85rem;
    }

    .chl-details-info-item {
        font-size: 0.85rem;
    }

    .container-inner.wrapped {
        padding: 0;
    }

    .middle-div.wrapped {
        padding: 20px;
    }
}

@media (hover: none) and (pointer: coarse) {
    #new-task-options-container-inner {
        padding: 15px;
    }
}

@media (max-width: 575px) {
	.container {
		padding: 0;
	}

    .practice-outer-div {
        width: 100%;
        padding: 15px;
        max-height: 90%;
    }

    .practice-label {
        font-size: 1.75rem;
    }

    #new-task-options-container-inner {
        overflow-y: auto;
        scrollbar-gutter: stable;
        padding: 0;
    }

    .personal-chl-inner {
        padding: 15px;
    }

    .container-inner.wrapped {
        padding: 0;
    }

    .middle-div.wrapped {
        padding: 15px;
    }
}

/* POPUP STYLES END */
</style>
</head>

<body>
	<div id="customConfirmModal" class="modal">
    <div class="modal-content">
        <p id="customModalText"></p>
        <div class="modal-buttons">
        <button id="customConfirmYes" class="btn btn-confirm">Taip</button>
        <button id="customConfirmNo" class="btn btn-cancel">Ne</button>
        </div>
    </div>
    </div>

    <div id="object-popup" class="object-popup-overlay" style="display:none;">
    <div class="object-popup-panel">
        <button class="object-popup-close">&times;</button>
        <div class="title-subtitle-inline-button-wrapper">
        <div class="object-popup-title-subtitle-wrapper">
        <div class="object-popup-title" id="object-popup-title"></div>
        <div class="object-popup-subtitle" id="object-popup-subtitle"></div>
        </div>
        </div>
        <div class="object-popup-content" id="object-popup-content">
        <!-- Dynamic content goes here -->
        </div>
    </div>
    </div>

     <nav class="main-navbar" id="mainNavbar">
        <div class="main-nav-container">
            <!-- Logo -->
            <a href="#" class="main-nav-logo">
                <div class="main-nav-logo-icon">
                 <img id="sudedu-main-nav-bar-logo" src="../images/sudedu_logo.png" alt="sudEdu">
                </div>
            </a>

            <!-- Desktop Navigation -->
            <div class="main-nav-links invisible">
                <a href="index.html" class="main-nav-link main-nav-link-active">Praktika</a>
                <a href="uzduotys.html" class="main-nav-link">Užduotys</a>
                <a href="klase.html" class="main-nav-link">Klasė</a>
                <a href="augintiniai.html" class="main-nav-link">Augintiniai</a>
                <a href="apie.html" class="main-nav-link">Apie Sudedu</a>
                
                <div class="main-nav-language-dropdown" id="languageDropdown">
                    <button class="main-nav-language-btn" id="languageBtn">
                        <span id="currentLanguage">LT</span>
                        <span class="main-nav-language-arrow"></span>
                    </button>
                    <div class="main-nav-language-menu">
                        <button class="main-nav-language-option selected" data-lang="LT">LT</button>
                        <button class="main-nav-language-option" data-lang="EN">EN</button>
                    </div>
                </div>
                
                
                <div class="main-nav-connect-wrapper">
                    <div class="main-nav-connect-glow"></div>
                    <button class="main-nav-log-out-btn">
                        <span class="main-nav-connect-text">Atsijungti</span>
                    </button>

                    <button class="main-nav-log-in-btn">
                        <span class="main-nav-connect-text">Prisijungti</span>
                    </button>
                </div>
            </div>

            <!-- Mobile Button -->
            <button class="main-nav-mobile-btn" id="mainNavMobileBtn">
                <span class="main-nav-hamburger"></span>
                <span class="main-nav-hamburger"></span>
                <span class="main-nav-hamburger"></span>
            </button>

            <!-- Mobile Menu -->
            <div class="main-nav-mobile-menu" id="mainNavMobileMenu">
                <a href="index.html" class="main-nav-mobile-link active">Praktika</a>
                <a href="uzduotys.html" class="main-nav-mobile-link">Užduotys</a>
                <a href="klase.html" class="main-nav-mobile-link">Klasė</a>
                <a href="augintiniai.html" class="main-nav-mobile-link">Augintiniai</a>
                <a href="apie.html" class="main-nav-mobile-link">Apie Sudedu</a>
                
                <div class="main-nav-mobile-language">
                    <button class="language-option language-option-LT selected" onclick="setLanguage('LT')">LT</button>
                    <span class="language-separator">/</span>
                    <button class="language-option language-option-EN" onclick="setLanguage('EN')">EN</button>
                </div>
                
                <button class="main-nav-mobile-log-out-btn">
                    <span class="main-nav-connect-text">Atsijungti</span>
                </button>
                <button class="main-nav-mobile-log-in-btn">
                    <span class="main-nav-connect-text">Prisijungti</span>
                </button>
            </div>
        </div>
    </nav>


	<div class="container" id="template-container" hidden>		
		<!-- POPUP ELEMENTS START -->
		<div class="class-popup-modal" id="classPopup">
			<div class="class-popup-content">
				<h2 class="class-popup-title">Pasirink savo klasę</h2>
				<div class="class-options" style="flex-direction: column;">
					<div class="class-option" data-class="0">Priešmokyklinė</div>
					<div class="class-option" data-class="1">1 klasė</div>
					<div class="class-option" data-class="2">2 klasė</div>
					<div class="class-option" data-class="3">3 klasė</div>
					<div class="class-option" data-class="4">4 klasė</div>
					<div class="class-option" data-class="5">Aukštesnė</div>
				</div>
				<button class="class-popup-button" id="classPopupButton" disabled>Toliau</button>
			</div>
		</div>
		<!-- POPUP ELEMENTS END -->

		<div class="container-inner">
			<div class="middle-div hide-scrollbar">
                <div class="practice-outer-div">
				<div class="practice-label-div free-practice-div">
					<div class="practice-label">PRAKTIKUOTIS</div>
				</div>
				<div class="new-task-outer-div" id="middle-div-row">
		                <div id="new-task-options-container">
                            <div id="new-task-options-container-inner">
                            <div class="ode_choice_div">
                                <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice" id="mode_choice">
                                    <option value="matematika">MATEMATIKĄ</option>
                                    <option value="kalba">LIETUVIŲ KALBĄ</option>
                                </select>
                            </div>

                            <div class="mode_choice_1_div">
                                <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_1" id="mode_choice_1">
                                    <option value="C1">SUDĖTĮ</option>
                                    <option value="C2">ATIMTĮ</option>
                                    <option value="C3">SUDĖTĮ IR ATIMTĮ</option>
                                    <option value="C4">DAUGYBĄ</option>
                                    <option value="C5">DALYBĄ</option>
                                    <option value="C6">DAUGYBĄ IR DALYBĄ</option>
                                    <option value="C7">ĮVAIRIUS VEIKSMUS</option>
                                </select>
                            </div>

                            <div class="mode_choice_2_div">
                                <div class="col-12 d-flex justify-content-center align-items-center mode_choice_2_div text-center" id="mode_choice_2_div">
                                    <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_2" id="mode_choice_2">
                                        <option value="C8">VIENAŽENKLIŲ SKAIČIŲ IKI 10</option>
                                        <option value="C9">VIENAŽENKLIŲ SKAIČIŲ IKI 20 (LENTELINĖ SUDĖTIS)</option>
                                        <option value="C10">DVIŽENKLIO IR VIENAŽENKLIO SKAIČIŲ IKI 20</option>
                                        <option value="C11">DVIŽENKLIO IR VIENAŽENKLIO SKAIČIŲ IKI 100</option>
                                        <option value="C12">DVIŽENKLIŲ SKAIČIŲ IKI 100</option>
                                        <option value="C13">SKAIČIŲ IKI 1 000</option>
                                        <option value="C14">SKAIČIŲ IKI 10 000</option>
                                        <option value="C15">SKAIČIŲ IKI 1 000 000</option>
                                    </select>
                                </div>
                            </div>

                            <div class="selected_numbers_div">
                                <div class="selected_numbers_inner_div">
                                    <label class="number-choice-label-nuo" for="selected_number" id="number_label" style="display: none;">NUO</label>
                                    <select class="btn btn-secondary dropdown-toggle dropdown text-center" name="selected_number" id="selected_number" style="display: none;">
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                        <option value="9">9</option>
                                        <option value="10">10</option>
                                    </select>
                                    <label class="number-choice-label-iki" for="selected_number_2" id="number_label_2" style="display: none;">IKI</label>
                                    <select class="btn btn-secondary dropdown-toggle dropdown text-center" name="selected_number_2" id="selected_number_2" style="display: none;">
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                        <option value="9">9</option>
                                        <option value="10">10</option>
                                    </select>
                                </div>
                            </div>

                            <div class="remainder-div">
                                <label id="remainder-option" style="display: none;">
                                    <input id="remainder-input" type="checkbox" name="myCheckbox"> DALYBA SU LIEKANA
                                </label>
                            </div>

                            <div class="mode_choice_3_div">
                                <div class="col-12 d-flex justify-content-center align-items-center text-center mode_choice_3_div" id="mode_choice_3_div">
                                    <select class="btn btn-secondary dropdown-toggle dropdown text-center" name="mode_choice_3" id="mode_choice_3">
                                        <option value="C37">NEPERŽENGIANT DEŠIMTIES</option>
                                    </select>
                                </div>
                            </div>

                            <div class="mode_choice_5_div">
                                <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_5" id="mode_choice_5">
                                    <option value="C41">SKAITINĖ LYGYBĖ</option>
                                    <option value="C42">SKAITINĖ LYGYBĖ SU NEŽINOMUOJU</option>
                                </select>
                            </div>

                            <div class="mode_choice_6_div">
                                <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_6" id="mode_choice_6" style="display: none;">
                                    <option value="C43">NEŽINOMAS DĖMUO</option>
                                </select>
                            </div>

                            <div class="mode_choice_7_div">
                                <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_7" id="mode_choice_7" style="display: block;">
                                    <option value="C47">EILUTE</option>
                                    <option value="C48">STULPELIU / KAMPU</option>
                                </select>
                            </div>

                            <div class="class_choice_div">
                                <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="class_choice" id="class_choice" style="display: none;">
                                    <option value="C75">1-2 KLASĖ</option>
                                    <option value="C76">3-4 KLASĖ</option>
                                </select>
                            </div>

                            <div class="mode_choice_8_div">
                                <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_8" id="mode_choice_8" style="display: none;">
                                    <option value="tekstas">TEKSTO SUPRATIMĄ</option>
                                    <option value="rasyba">RAŠYBĄ</option>
                                </select>
                            </div>

                            <div class="mode_choice_9_div">
                                <div class="col-12 d-flex justify-content-center align-items-center mode_choice_9_div text-center" id="mode_choice_9_div">
                                    <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_9" id="mode_choice_9" style="display: none;">
                                        <option value="C51">TURINIO KOMPONAVIMĄ</option>
                                        <option value="C52">STRUKTŪROS IŠDĖSTYMĄ</option>
                                    </select>
                                </div>
                            </div>

                            <div class="mode_choice_10_div">
                                <div class="col-12 d-flex justify-content-center align-items-center mode_choice_10_div text-center" id="mode_choice_10_div">
                                    <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_10" id="mode_choice_10" style="display: none;">
                                        <option value="C58">LENGVAS</option>
                                        <option value="C80">LENGVAS SU DISTRAKTORIUMI</option>
                                        <option value="C59">VIDUTINIS</option>
                                        <option value="C81">VIDUTINIS SU DISTRAKTORIUMI</option>
                                        <option value="C60">SUNKUS</option>
                                        <option value="C82">SUNKUS SU DISTRAKTORIUMI</option>
                                    </select>
                                </div>
                            </div>

                            <div class="rasyba-options-row">
                                <div class="mode_choice_11_div" id="mode_choice_11_div" style="display: none;">
                                    <label class="rasyba-options-label">
                                        <input type="checkbox" class="r" name="r" value='GALŪNĖS' checked><span class="rasyba-options-label-text" id="rasyba-options-label-text-galune">ŽODŽIO PABAIGA:</span>
                                    </label>
                                    <br>
                                    <div id="galuniu-div">
                                        <label class="rasyba-options-label" style="display: none;">
                                            <input type="checkbox" class="rasyba-options options-for-first-second-classes-input" id="first-second-class-endings" name="rasyba-option" value='{"C61": []}' checked><span class="rasyba-options-label-text">DAIKTAVARDIS</span>
                                            <br>
                                        </label>
                                        <label class="rasyba-options-label options-for-third-fourth-classes" style="display: none;">
                                            <input type="checkbox" class="rasyba-options options-for-third-fourth-classes-input" name="rasyba-option" value='{"C62": []}'><span class="rasyba-options-label-text">DAIKTAVARDŽIAI</span>
                                            <br>
                                        </label>
                                        <label class="rasyba-options-label options-for-third-fourth-classes" style="display: none;">
                                            <input type="checkbox" class="rasyba-options options-for-third-fourth-classes-input" name="rasyba-option" value='{"C63": [], "C64": []}'><span class="rasyba-options-label-text">BŪDVARDŽIAI IR PRIEVEIKSMIAI</span>
                                            <br>
                                        </label>
                                        <label class="rasyba-options-label options-for-third-fourth-classes" style="display: none;">
                                            <input type="checkbox" class="rasyba-options options-for-third-fourth-classes-input" name="rasyba-option" value='{"C65": []}'><span class="rasyba-options-label-text">VEIKSMAŽODŽIAI</span>
                                            <br>
                                        </label>
                                        <div class="mode_choice_12_div" id="mode_choice_12_div">
                                            <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_12" id="mode_choice_12">
                                                <option value="C73">LENGVESNĖS KOMBINACIJOS</option>
                                                <option value="C74">SUNKESNĖS KOMBINACIJOS</option>
                                            </select>
                                        </div>
                                    </div>
                                    <label class="rasyba-options-label">
                                        <input id="C66" type="checkbox" class="rasyba-options" name="rasyba-option" value='{"C66": []}' checked><span class="rasyba-options-label-text">ĮSIDĖMĖTINA RAŠYBA</span>
                                        <br>
                                    </label>
                                    <label class="rasyba-options-label options-for-third-fourth-classes" style="display: none;">
                                        <input type="checkbox" class="rasyba-options options-for-third-fourth-classes-input" name="rasyba-option" value='{"C71": []}'><span class="rasyba-options-label-text">PRIEBALSIŲ SUPANAŠĖJIMAS</span>
                                        <br>
                                    </label>
                                    <label class="rasyba-options-label options-for-first-second-classes" style="display: block;">
                                        <input type="checkbox" class="rasyba-options options-for-first-second-classes-input" name="rasyba-option" value='{"C67": []}'checked><span class="rasyba-options-label-text">PANAŠIAI SKAMBANČIOS PRIEBALSĖS</span>
                                        <br>
                                    </label>
                                    <label class="rasyba-options-label" style="display: block;">
                                        <input type="checkbox" class="rasyba-options" name="rasyba-option" value='{"C68": []}' checked><span class="rasyba-options-label-text">BALSĖS IR DVIBALSĖS</span>
                                        <br>
                                    </label>
                                    <label class="rasyba-options-label options-for-third-fourth-classes" style="display: none;">
                                        <input type="checkbox" class="rasyba-options options-for-third-fourth-classes-input" name="rasyba-option" value='{"C72": []}'><span class="rasyba-options-label-text">MIŠRIEJI DVIGARSIAI</span>
                                        <br>
                                    </label>
                                    <label class="rasyba-options-label options-for-third-fourth-classes" style="display: none;">
                                        <input type="checkbox" class="rasyba-options options-for-third-fourth-classes-input" name="rasyba-option" value='{"C69": []}'><span class="rasyba-options-label-text">PRIEŠDĖLIAI</span>
                                        <br>
                                    </label>
                                    <label class="rasyba-options-label options-for-third-fourth-classes" style="display: none;">
                                        <input type="checkbox" class="rasyba-options options-for-third-fourth-classes-input" name="rasyba-option" value='{"C70": []}'><span class="rasyba-options-label-text">PRIESAGOS</span>
                                        <br>
                                    </label>
                                </div>

                                <div class="mode_choice_13_div">
                                    <div class="row"></div>
                                    <div class="col-12 d-flex justify-content-center align-items-center mode_choice_13_div text-center" id="mode_choice_13_div">
                                        <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="mode_choice_13" id="mode_choice_13" style="display: none;">
                                            <option value="3">RETESNI ATVEJAI</option>
                                            <option value="1">DAŽNESNI ATVEJAI</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="modeChoice4_div">
                                <select class="btn btn-secondary dropdown-toggle dropdown dropdown-options" name="modeChoice4" id="mode_choice_4" style="display: block;">
                                    <option value="C39">NUSTATYTI LAIKO TRUKMĘ</option>
                                    <option value="C40">NUSTATYTI VEIKSMŲ KIEKĮ</option>
                                </select>
                            </div>

                            <div class="timer-question-number-div">
                            <div class="timer-input-div" id="timer-input-div">
                                <div class="input-group">
                                    <div class="input-wrapper">
                                        <button class="control-btn" 
                                                onmousedown="startHold('timer-input', 1, 60, false)"
                                                onmouseup="stopHold()"
                                                onmouseleave="stopHold()"
                                                ontouchstart="event.preventDefault(); startHold('timer-input', 1, 60, false)"
                                                ontouchend="stopHold()"
                                                ontouchcancel="stopHold()">−</button>
                                        <input type="number" class="timer-input" id="timer-input" min="1" max="60" step="1" value="5" readonly>
                                        <button class="control-btn" 
                                                onmousedown="startHold('timer-input', 1, 60, true)"
                                                onmouseup="stopHold()"
                                                onmouseleave="stopHold()"
                                                ontouchstart="event.preventDefault(); startHold('timer-input', 1, 60, true)"
                                                ontouchend="stopHold()"
                                                ontouchcancel="stopHold()">+</button>
                                    </div>
                                    <h3 class="timer-choice-label">minutes</h3>
                                </div>
                            </div>
                            <div class="question-number-input-div" id="question-number-input-div" style="display: none;">
                                <div class="input-group">
                                    <div class="input-wrapper">
                                        <button class="control-btn" 
                                                onmousedown="startHold('question-number-input', 1, 200, false)"
                                                onmouseup="stopHold()"
                                                onmouseleave="stopHold()"
                                                ontouchstart="event.preventDefault(); startHold('question-number-input', 1, 200, false)"
                                                ontouchend="stopHold()"
                                                ontouchcancel="stopHold()">−</button>
                                        <input type="number" class="question-number-input" id="question-number-input" min="1" max="200" step="1" value="20" readonly>
                                        <button class="control-btn" 
                                                onmousedown="startHold('question-number-input', 1, 200, true)"
                                                onmouseup="stopHold()"
                                                onmouseleave="stopHold()"
                                                ontouchstart="event.preventDefault(); startHold('question-number-input', 1, 200, true)"
                                                ontouchend="stopHold()"
                                                ontouchcancel="stopHold()">+</button>
                                    </div>
                                    <h3 class="answer-number-label">veiksmus</h3>
                                </div>
                            </div>
                            </div>
                        </div>
                    </div>
				</div>
            <div class="submit-button-div">
				<button class="submit-button">Pradėti</button>
			</div>
            </div>
            <div class="personal-chl">
                <div class="personal-chl-inner">
                <div class="practice-label-div chl-label-div">
					<div class="practice-label">IŠŠŪKIAI</div>
				</div>
                <div class="personal-chl-list-container" id="personalChlContainer"></div>
            </div>
            </div>
			</div>
		</div>


	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="../parameter_dictionary.js"></script>
	<script src="../mental-arithmetic.js"></script>
	<script src="../mental-arithmetic-combinations.js"></script>
    <script src="../main-nav-bar.js"></script>
	<script src="matematika_options.js"></script>

	<script>
        let userClass;


		function submitSelection() {
			let modeChoiceSelection = document.querySelector('#mode_choice').value;
			if (localStorage.getItem('controller') !== null) {
				controller = JSON.parse(localStorage.getItem('controller'))
			}

			if (modeChoiceSelection === "matematika") {
				controller.mode = 'math';
			} else if (modeChoiceSelection === "kalba") {
				controller.mode = 'lang';
			}

			controller.language = "LT";

			if (controller.mode === "math") {
				modeChoice1Selection = modeChoice1Element.value;
				modeChoice2Selection = modeChoice2Element.value;
				selectedNumbers = [selectedNumberElement.value, selectedNumber2Element.value].sort();
				modeChoice3Selection = modeChoice3Element.value;
				modeChoice5Selection = modeChoice5Element.value;
				modeChoice6Selection = modeChoice6Element.value;
				modeChoice7Selection = modeChoice7Element.value;

				var checkbox = document.getElementById("remainder-input");

				controller.modeChoice1 = modeChoice1Selection;
				controller.modeChoice2 = modeChoice2Selection;
				controller.selectedNumbers = selectedNumbers;
				controller.withRemainder = checkbox.checked;
				if (modeChoice3Selection === "C37") {
					controller.modeChoice3 = true;
				} else if (modeChoice3Selection === "C38") {
					controller.modeChoice3 = false;
				}
				controller.modeChoice5 = modeChoice5Selection;
				controller.modeChoice6 = modeChoice6Selection;
				controller.modeChoice7 = modeChoice7Selection;
				controller.modeChoice8 = 'C79';
				controller.result = ['', '', '', '', '']
				controller.task = null;

			} else if (controller.mode === "lang") {
				const modeChoice8Value = document.querySelector('#mode_choice_8').value;
				const rasybaOptions = document.querySelectorAll('[name="rasyba-option"]');
				let anyChecked = false;
				rasybaOptions.forEach(option => {
				if (option.checked) {
					anyChecked = true;
				}
				});
			if ((modeChoice8Value === "rasyba" && anyChecked) || modeChoice8Value !== "rasyba") {
				modeChoice8Selection = modeChoice8Element.value;
				modeChoice9Selection = modeChoice9Element.value;
				modeChoice12Selection = modeChoice12Element.value;
				modeChoice13Selection = modeChoice13Element.value;
				classChoiceSelection = classChoiceElement.value;

				controller.classChoice = classChoiceSelection;
				if (modeChoice8Selection === "tekstas") {
					controller.modeChoice1 = "C49";
				} else if (modeChoice8Selection === "rasyba") {
					controller.modeChoice1 = "C50";
				}

				if (modeChoice9Selection === "C53") {
					controller.modeChoice2 = "1";
				} else if (modeChoice9Selection === "C54") {
					controller.modeChoice2 = "2";
				} else if (modeChoice9Selection === "C55") {
					controller.modeChoice2 = "3";
				} else if (modeChoice9Selection === "C56") {
					controller.modeChoice2 = "4";
				} else if (modeChoice9Selection === "C57") {
					controller.modeChoice2 = "5";
				} else {
					controller.modeChoice2 = modeChoice9Selection;
				}
				controller.modeChoice3 = getSelectedRasybaConditions();
				controller.modeChoice5 = modeChoice12Selection;
				controller.result = ['', '', '', '', ''];
				controller.modeChoiceLtDifficulty = document.getElementById('mode_choice_10').value;
				if (controller.classChoice === "C75") {
					controller.questionFrequency = Number(modeChoice13Selection);
				} else {
					controller.questionFrequency = 1;
				}
			}
		}
        	controller.modeChoice4 = modeChoice4Element.value
			localStorage.setItem('controller', JSON.stringify(controller))

			if (controller.modeChoice4 === "C39") {
				startQuestionsTimer()
			} else if (controller.modeChoice4 = "C40") {
				startQuestionsNumber()
			}
		}

		let submitButtonElement = document.querySelector('.submit-button');
		submitButtonElement.addEventListener("click", submitSelection);

		window.onload = function () {
            const savedController = localStorage.getItem('controller');
            if (savedController) {
                controller = JSON.parse(savedController);
            }
            if (controller) {
                controller.task = null;
                controller.taskCompleted = false;
                localStorage.setItem('controller', JSON.stringify(controller));
            }
			document.querySelector('#template-container').removeAttribute('hidden');
		};

		window.addEventListener("pageshow", function() {
    var selects = document.querySelectorAll('select');
    selects.forEach(function(select) {
        var selectedOption = select.querySelector('[selected]');
        var selectedIndex = selectedOption ? Array.from(select.children).indexOf(selectedOption) : 0;
        select.selectedIndex = selectedIndex;
    });

    var checkbox = document.getElementById('remainder-input');
    if (checkbox) {
        checkbox.checked = false; // Deselect the checkbox
    }
});

	if (localStorage.getItem('controller') !== null) {
	controller = JSON.parse(localStorage.getItem('controller'));
	controller.language = "LT";
	localStorage.setItem('controller', JSON.stringify(controller));
}


//POPUP SCRIPT START

// Function to set value in localStorage with expiration
function setClassLocalStorage(classValue) {
    const now = new Date();
    // Set expiration to 2 months from now
    const expiration = new Date(now.setMonth(now.getMonth() + 2));
    
    const item = {
        value: classValue,
        expiration: expiration.getTime()
    };
    
    localStorage.setItem("userClassV2", JSON.stringify(item));
}

// Function to get value from localStorage and check expiration
function getClassLocalStorage() {
    const itemStr = localStorage.getItem("userClassNotLoggedIn");
    
    // If the item doesn't exist, return null
    if (!itemStr) {
        return null;
    }
    
    const item = JSON.parse(itemStr);
    const now = new Date();
    
    // Compare the expiration time with the current time
    if (now.getTime() > item.expiration) {
        // If the item is expired, delete it and return null
        localStorage.removeItem("userClassV2");
        return null;
    }
    
    return item.value;
}

// Function to show the class popup
function showClassPopup() {
    const popup = document.getElementById('classPopup');
    const nextButton = document.getElementById('classPopupButton');
    let selectedClass = null;
    
    popup.classList.add('active');
    document.body.classList.add('popup-active');
    
    // Add event listeners to class options
    const classOptions = document.querySelectorAll('.class-option');
    classOptions.forEach(option => {
        option.addEventListener('click', function() {
            // Remove selected class from all options
            classOptions.forEach(opt => opt.classList.remove('selected'));
            // Add selected class to clicked option
            this.classList.add('selected');
            
            // Store the selected class
            selectedClass = Number(this.getAttribute('data-class'));
            
            // Enable the Next button
            nextButton.disabled = false;
        });
    });
    
    // Add event listener to Next button
    nextButton.addEventListener('click', function() {
        if (selectedClass) {
            // Set localStorage with selected class and expiration
            setClassLocalStorage(selectedClass);

            userClass = selectedClass;

            if (userData) {
                updateUserClass (userClass);
                userData.knowledgeLvl = userClass;
                localStorage.setItem('userData', JSON.stringify(userData));
            }
            
            // Close popup
            popup.classList.remove('active');
            document.body.classList.remove('popup-active');
        }
    });

    displayPersonalChl();
}

async function updateUserClass (userClassSelection) {
    try {
        const response = await apiFetch(apiBase + `students/knowledge-level`, {
            method: "PATCH",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                studentId: userData.userId,
                knowledgeLvl: Number(userClassSelection)
            })
        });

        if (!response) {
            return;
        }

        if (!response.ok) {
            throw new Error("Nepavyko atnaujinti lygio");
        }

        const data = await response.json();
    } catch (error) {
        console.error("Error updating knowledge level:", error);
    }
}

//POPUP SCRIPT END

const timerInputElement = document.querySelector('#timer-input');
const questionNumberInputElement = document.querySelector('#question-number-input');

const personalChlDict = {
    0: {
        "math": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "text-comp": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "grammar": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ]
    },
    1: {
        "math": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "text-comp": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "grammar": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ]
    },
    2: {
        "math": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "text-comp": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "grammar": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ]
    },
    3: {
        "math": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "text-comp": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "grammar": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ]
    },
    4: {
        "math": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "text-comp": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ],
        "grammar": [
            '["math","C4","C18",null,"C40","C41","C45","C47",["1","4"],false,"5","C79"]'
        ]
    },
}

const typeLabels = {
    "math": "Matematika",
    "text-comp": "Teksto supratimas",
    "grammar": "Rašyba"
};

function displayPersonalChl() {
    const container = document.getElementById('personalChlContainer');
    const userClass = 0; // Replace with actual user class
    
    if (!personalChlDict[userClass]) {
        container.innerHTML = '<p style="text-align: center; color: rgba(0,0,0,0.5);">Nėra prieinamų iššūkių</p>';
        return;
    }

    const classData = personalChlDict[userClass];
    const challenges = Object.keys(classData).map(key => {
        const items = classData[key];
        const randomItem = items[Math.floor(Math.random() * items.length)];
        const randomItemInfo = getOptionTextFromValues(JSON.parse(randomItem));

        return {
            type: key,
            chl: randomItem,
            chlInfo: randomItemInfo
        };
    });

    container.innerHTML = '';

    challenges.forEach(challenge => {
        const card = document.createElement('div');
        card.className = 'chl-card';
        card.dataset.challenge = challenge.chl;
        card.dataset.type = challenge.type;

        // Card header
        const header = document.createElement('div');
        header.className = 'chl-card-header';

        const headerLeft = document.createElement('div');
        headerLeft.className = 'chl-card-header-left';

        const badge = document.createElement('div');
        badge.className = `chl-type-badge chl-type-${challenge.type}`;
        badge.textContent = typeLabels[challenge.type] || challenge.type;

        const info = document.createElement('div');
        info.className = 'chl-info-text';
        info.textContent = challenge.chlInfo.join(' • ');

        headerLeft.appendChild(badge);

        const expandIcon = document.createElement('div');
        expandIcon.className = 'chl-expand-icon';
        expandIcon.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg>`;

        header.appendChild(headerLeft);
        header.appendChild(expandIcon);

        // Card details (hidden by default)
        const details = document.createElement('div');
        details.className = 'chl-card-details';

        const button = document.createElement('button');
        button.className = 'chl-action-button';
        button.textContent = 'Atlikti';
        button.onclick = (e) => {
            e.stopPropagation();
            completePersonalChlTask(challenge.chl)
        };

        const buttonHolder = document.createElement('div');
        buttonHolder.className = 'chl-action-button-holder';

        buttonHolder.appendChild(button);

        details.appendChild(headerLeft.appendChild(info));
        details.appendChild(buttonHolder);

        card.appendChild(header);
        card.appendChild(details);

        card.addEventListener('click', () => toggleCard(card));

        container.appendChild(card);
    });
}

function toggleCard(clickedCard) {
    const allCards = document.querySelectorAll('.chl-card');
    const container = document.querySelector('.middle-div'); // scrollable container

    // Collapse other cards
    allCards.forEach(card => {
        if (card !== clickedCard && card.classList.contains('expanded')) {
            card.classList.remove('expanded');
        }
    });

    const isExpanding = !clickedCard.classList.contains('expanded');
    clickedCard.classList.toggle('expanded');

    if (isExpanding && container) {
        setTimeout(() => {
            // Get card's position relative to the container
            const cardRect = clickedCard.getBoundingClientRect();
            const containerRect = container.getBoundingClientRect();

            const cardBottomRelative = cardRect.bottom - containerRect.top;
            const containerHeight = container.clientHeight;

            // If card bottom is below visible area, scroll
            if (cardBottomRelative > containerHeight) {
                const scrollAmount = container.scrollTop + (cardBottomRelative - containerHeight + 20); // 20px padding
                container.scrollTo({
                    top: scrollAmount,
                    behavior: 'smooth'
                });
            }
        }, 400);
    }
}


function completePersonalChlTask(challengeInfo) {
    const parsedCurrentTaskInstructions = JSON.parse(challengeInfo);

    if (localStorage.getItem('controller') !== null) {
        controller = JSON.parse(localStorage.getItem('controller'))
    }

    var checkbox = document.getElementById("remainder-input");

    controller.language = "LT";
    if (parsedCurrentTaskInstructions[0] === "math") {
        controller.mode = 'math';
        controller.modeChoice1 = parsedCurrentTaskInstructions[1];
        controller.modeChoice2 = parsedCurrentTaskInstructions[2];
        controller.selectedNumbers = parsedCurrentTaskInstructions[8];
        controller.withRemainder = parsedCurrentTaskInstructions[9];
        controller.modeChoice3 = parsedCurrentTaskInstructions[3];
        controller.modeChoice4 = parsedCurrentTaskInstructions[4];
        controller.modeChoice5 = parsedCurrentTaskInstructions[5];
        controller.modeChoice6 = parsedCurrentTaskInstructions[6];
        controller.modeChoice7 = parsedCurrentTaskInstructions[7];
        controller.modeChoice8 = "C79";
        controller.taskCompleted = false;
        controller.setTaskDuration = parsedCurrentTaskInstructions[10];

    } else if (parsedCurrentTaskInstructions[0] === "lang") {
        controller.mode = 'lang';
        controller.classChoice = parsedCurrentTaskInstructions[1];
        controller.modeChoice1 = parsedCurrentTaskInstructions[2];
        controller.modeChoice2 = parsedCurrentTaskInstructions[3];
        controller.modeChoice3 = parsedCurrentTaskInstructions[4];
        controller.modeChoice4 = parsedCurrentTaskInstructions[5];
        controller.modeChoice5 = parsedCurrentTaskInstructions[6];
        controller.modeChoiceLtDifficulty = parsedCurrentTaskInstructions[7];
        controller.questionFrequency = parsedCurrentTaskInstructions[8];
        controller.taskCompleted = false;
        controller.setTaskDuration = parsedCurrentTaskInstructions[9];
    }

    localStorage.setItem('controller', JSON.stringify(controller))

    startQuestions();
}
displayPersonalChl();

function checkWrap() {
  const middleDivEl = document.querySelector('.middle-div');
  const containerInnerEl = document.querySelector('.container-inner');
  const practiceHolderDiv = document.querySelector(".practice-outer-div");
  const personalChlHolderDiv = document.querySelector(".personal-chl");
  if (!middleDivEl || !containerInnerEl || !practiceHolderDiv || !personalChlHolderDiv) return;

  middleDivEl.classList.remove('wrapped');
  const wrapped = personalChlHolderDiv.offsetTop > practiceHolderDiv.offsetTop;
  
  middleDivEl.classList.toggle('wrapped', wrapped);
  containerInnerEl.classList.toggle('wrapped', wrapped);
  
  // Call setProperHeight after wrapping changes
  if (wrapped) {
    setTimeout(setProperHeight, 50);
  } else {
    document.querySelector('.practice-outer-div').style.height = "100%";
  }
}

function setProperHeight() {
  const middleDiv = document.querySelector('.middle-div');
  const outer = document.querySelector('.practice-outer-div');
  
  if (!middleDiv || !outer) return;

  // Only run if wrapped
  if (!middleDiv.classList.contains('wrapped')) return;

  // Reset height to auto first
  outer.style.height = 'auto';

  // Force reflow
  outer.offsetHeight;

  // Use requestAnimationFrame for accurate measurement
  requestAnimationFrame(() => {
    const container = document.getElementById('new-task-options-container-inner');
    if (!container) return;

    const fullHeight = container.scrollHeight;
    const practiceLabel = outer.querySelector('.practice-label-div');
    const submitButton = outer.querySelector('.submit-button-div');
    
    // Calculate total needed height
    const labelHeight = practiceLabel ? practiceLabel.offsetHeight : 0;
    const buttonHeight = submitButton ? submitButton.offsetHeight : 0;
    const padding = 40; // padding from .practice-outer-div
    
    const totalHeight = fullHeight + labelHeight + buttonHeight + padding;
    
    outer.style.height = totalHeight + 20 + 'px';
    
    // Update overflow class after height is set
    setTimeout(updateOverflowClass, 50);
  });
}

window.addEventListener('resize', checkWrap);

function updateOverflowClass() {
  const container = document.getElementById('new-task-options-container-inner');
  const practiceDiv = document.querySelector('.practice-outer-div');
  if (!container || !practiceDiv) return;

  // Compare scrollHeight to offsetHeight (visible height)
  const isOverflowing = container.scrollHeight > container.offsetHeight;
  practiceDiv.classList.toggle('overflowing', isOverflowing);
}

// Run on load, resize, and DOM changes
window.addEventListener('load', updateOverflowClass);
window.addEventListener('resize', updateOverflowClass);

// Optional: detect dynamic content changes
const observer = new MutationObserver(updateOverflowClass);
observer.observe(document.getElementById('new-task-options-container-inner'), { childList: true, subtree: true });


window.addEventListener('resize', checkWrap);
window.addEventListener('load', checkWrap);


	</script>
</body>

</html>
